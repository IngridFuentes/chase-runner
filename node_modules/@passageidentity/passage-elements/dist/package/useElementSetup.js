"use strict";var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,l=(e,t,n)=>new Promise(((a,o)=>{var i=e=>{try{l(n.next(e))}catch(t){o(t)}},r=e=>{try{l(n.throw(e))}catch(t){o(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,r);l((n=n.apply(e,t)).next())})),s=require("./customElements.js"),c=require("./socialConnectionMetadata.js");function u(e){return null==e||""===e||" "===e}var d=(e=>(e.phone="PHONE",e.email="EMAIL",e))(d||{});function p(){const e=s.ref();return s.watch(e,(()=>{void 0!==e.value&&null!==e.value&&e.value.focus()})),{autofocusButton:e}}const f={class:"identifier-form"},v={class:"has-text-centered"},m=(e=>(s.pushScopeId("data-v-12473444"),e=e(),s.popScopeId(),e))((()=>s.createBaseVNode("br",null,null,-1))),g={class:"identifier-text"},y=["onSubmit"],h=["autocomplete","inputmode","placeholder","onInput"],k={class:"flex-row flex-center"},b=["onClick"],B={key:0,style:{"margin-top":"30px"},class:"link has-text-centered"},V=["onClick"],w=s.defineComponent({__name:"ValidatedIdentifierForm",props:{validationError:{default:""},identifier:{},countryCode:{},identifierMode:{},showWelcomeBack:{type:Boolean,default:!1},conditionalUI:{type:Boolean,default:!1}},emits:["onSubmit","update:validationError","update:identifier","update:countryCode","update:showWelcomeBack"],setup(e,{emit:t}){const n=e,{t:a}=s.useLocale(),o=s.ref(""),i=s.ref(),r=s.ref(),{autofocusButton:w}=p(),{passage:I}=s.usePassage(),C=s.computed((()=>n.showWelcomeBack)),N=s.computed((()=>{let e;switch(n.identifierMode){case s.ue.phone:e=a("phone-number");break;case s.ue.email:e=a("email-address");break;case s.ue.both:e=a("email-or-phone-number")}return e.charAt(0).toUpperCase()+e.slice(1)})),_=s.computed((()=>"example@email.com")),S=s.computed((()=>n.identifierMode===s.ue.phone?"tel":"email")),x=s.computed((()=>{var e;return n.conditionalUI?`${S.value} webauthn`:null!=(e=S.value)?e:""})),E=s.computed({get:()=>n.identifier,set(e){t("update:identifier",e)}});function D(){var e;if(!E.value)return"";let t=E.value;return C.value||(t=R()?null!=(e=null==U?void 0:U.getNumber())?e:"":E.value),t.trim().toLowerCase()}const T=s.computed((()=>u(n.validationError)?u(o.value)?"":o.value:n.validationError));function L(){o.value="",t("update:validationError","")}function M(){return l(this,null,(function*(){if(!function(){if(""===D()){let e="";switch(n.identifierMode){case s.ue.phone:e=a("enter-a-phone-number");break;case s.ue.email:e=a("enter-an-email-address");break;case s.ue.both:e=a("enter-an-email-or-phone-number")}return o.value=e,!1}if(n.identifierMode===s.ue.email&&!A())return o.value=a("enter-a-valid-email-address"),!1;if(n.identifierMode===s.ue.phone&&!R())return o.value=a("enter-a-valid-phone-number"),!1;if(n.identifierMode===s.ue.both&&!R()&&!A())return o.value=a("enter-a-valid-email-or-phone-number"),!1;return!0}())return;let e,i,r,l=!1,c=[],u="";try{const t=yield I.identifierExists(D());null!==t?(e=!0,r=t.status,u=t.id,i=t.email_verified,l=t.phone_verified,c=t.webauthn_types):(e=!1,r=s.re.INACTIVE)}catch(p){let e;switch(n.identifierMode){case s.ue.email:e=a("enter-a-valid-email-address");break;case s.ue.phone:e=a("enter-a-valid-phone-number");break;case s.ue.both:e=a("enter-a-valid-email-or-phone-number")}return void(o.value=e)}t("onSubmit",{identifier:D(),identifierExists:e,identifierType:R()?d.phone:d.email,userStatus:r,userID:u,emailVerified:i,phoneVerified:l,webauthnTypes:c})}))}function A(){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(D())}function R(){return C.value?O():void 0!==U&&U.isValidNumber()}let U;function P(){void 0===U&&(i.value.addEventListener("countrychange",(()=>{var e;t("update:countryCode",null!=(e=null==U?void 0:U.getSelectedCountryData().iso2)?e:"")})),U=c.intlTelInput(i.value,{initialCountry:n.countryCode,utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",dropdownContainer:r.value,autoPlaceholder:"aggressive"}),i.value.focus())}function O(){return/^\+$|^\+?[0-9,(,),\-, ]+$/.test(E.value.trim())}s.onMounted((()=>{n.conditionalUI&&function(){const e=z.value.getRootNode().host;void 0!==e&&(z.value.appendChild(function(){const e=document.createElement("style");return e.appendChild(document.createTextNode("\n      .psg-input{\n        -webkit-appearance: none;\n        -moz-appearance: none;\n        box-sizing: border-box;\n        color: var(--passage-input-text-color, var(--passage-body-text-color-default));\n        font-family: var(--passage-body-font-family, var(--passage-body-font-family-default));\n        font-size: var(--passage-body-font-size, var(--passage-body-font-size-default));\n        font-weight: var(--passage-body-font-weight, var(--passage-body-font-weight-default));\n\n        min-height: 40px;\n        width: 100%;\n\n        padding-left: 10px;\n        padding-right: 10px;\n        margin: 0;\n\n        background-color: var(--passage-input-box-background-color, var(--passage-input-box-background-color-default));\n        border-style: solid;\n        border-color: var(--passage-control-border-color, var(--passage-control-border-color-default));\n        border-width: 1px;\n        border-radius: var(--passage-input-box-border-radius, var(--passage-input-box-border-radius-default));\n\n        transition: all 0.3s;\n\n        text-overflow: ellipsis;\n      }\n\n      .psg-input:hover {\n        border-color: var(--passage-control-border-hover-color, var(--passage-control-border-hover-color-default));\n      }\n\n      .psg-input:focus{\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-control-border-active-color, var(--passage-control-border-active-color-default));\n      }\n\n      .psg-input:active{\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-control-border-active-color, var(--passage-control-border-active-color-default));\n      }\n\n      .psg-input.has-error{\n        border-color: var(--passage-error-color, var(--passage-error-color-default));\n      }\n      .psg-input.is-danger{\n        border-color: var(--passage-error-color, var(--passage-error-color-default));\n      }\n      .iti {\n        width: 100%;\n      }\n\n        .iti__country-list {\n            border-radius: 6px;\n        }\n\n        .iti__country {\n            padding: 5px 10px;\n        }\n\n        .iti__selected-flag {\n            border-top-left-radius: var(--passage-control-border-radius, var(--passage-input-box-border-radius-default));\n            border-bottom-left-radius: var(--passage-control-border-radius, var(--passage-input-box-border-radius-default));\n        }\n\n    .iti--container {\n        top: unset !important;\n        left: unset !important;\n    }")),e}()),z.value.appendChild(function(){const e=document.createElement("link");return e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.16/css/intlTelInput.css",e}()),e.appendChild(z.value))}(),n.identifierMode===s.ue.phone&&P()})),n.identifierMode===s.ue.both&&s.watch(E,(()=>{O()?P():void 0!==U&&(U.destroy(),U=void 0,i.value&&i.value.focus())}));const F=s.computed((()=>n.countryCode));function j(){t("update:showWelcomeBack",!1),E.value=""}s.watch(F,(e=>{null==U||U.setCountry(e)}));const z=s.ref();return s.onBeforeUnmount((()=>{z.value.remove()})),(e,t)=>(s.openBlock(),s.createElementBlock("div",f,[s.withDirectives(s.createBaseVNode("div",v,[s.createTextVNode(s.toDisplayString(s.unref(a)("welcome-back-sign-in-as")),1),m,s.createBaseVNode("strong",g,s.toDisplayString(E.value),1)],512),[[s.vShow,e.showWelcomeBack]]),s.withDirectives(s.createBaseVNode("div",null,[s.createBaseVNode("div",{class:"label",ref:"labelRef"},s.toDisplayString(N.value),513),s.createBaseVNode("form",{ref_key:"identifierForm",ref:z,slot:"loginInput",onSubmit:s.withModifiers(M,["prevent"])},[s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),type:"text",class:s.normalizeClass(["input psg-input",{"is-danger":T.value}]),part:"input",autocomplete:x.value,inputmode:S.value,id:"identifier",placeholder:_.value,onInput:s.withModifiers(L,["prevent"]),"data-test":"identifier-input",ref_key:"identifierInput",ref:i},null,42,h),[[s.vModelText,E.value]])],40,y),s.renderSlot(e.$slots,"loginInput",{},void 0,!0)],512),[[s.vShow,!e.showWelcomeBack]]),s.createBaseVNode("div",{ref_key:"controlContainer",ref:r,style:{width:"100%"}},null,512),s.createBaseVNode("div",{style:s.normalizeStyle([`text-align: ${C.value?"center":"left"};`,{height:"32px"}]),class:"help is-danger error-message","data-test":"validation-error"},s.toDisplayString(T.value),5),s.renderSlot(e.$slots,"metadataFields",{},void 0,!0),s.createBaseVNode("div",k,[s.createBaseVNode("button",{class:"button is-primary",part:"button","data-test":"continue-button",ref_key:"autofocusButton",ref:w,onClick:s.withModifiers(M,["prevent"])},s.toDisplayString(s.unref(a)("continue")),9,b)]),C.value?(s.openBlock(),s.createElementBlock("div",B,[s.createBaseVNode("a",{onClick:s.withModifiers(j,["prevent"]),role:"button",class:"body-link","data-test":"register-link"},s.toDisplayString(s.unref(a)("switch-account")),9,V)])):s.createCommentVNode("",!0)]))}});var I=s._export_sfc(w,[["__scopeId","data-v-12473444"]]),C=(e=>(e.onLoaded="onLoaded",e.onRegisterDevice="onRegisterDevice",e.onVerifyIdentity="onVerifyIdentity",e.onMagicLinkLogin="onMagicLinkLogin",e.onMagicLinkRegister="onMagicLinkRegister",e.onMagicLinkActivated="onMagicLinkActivated",e.onMagicLinkActivateSuccess="onMagicLinkActivateSuccess",e.onOneTimePasscodeLogin="onOneTimePasscodeLogin",e.onOneTimePasscodeRegister="onOneTimePasscodeRegister",e.onOneTimePasscodeActivated="onOneTimePasscodeActivated",e.onOneTimePasscodeActivateSuccess="onOneTimePasscodeActivateSuccess",e))(C||{});const N=()=>!0,_=e=>{window.location.href=e.redirect_url},S=()=>{},x=s.ref(N),E=s.ref(_),D=s.ref(S);function T(e){x.value=void 0!==e?e:N}function L(e){E.value=void 0!==e?e:_}function M(e){D.value=void 0!==e?e:S}function A(){return{beforeAuth:s.readonly(x),onSuccess:s.readonly(E),onEvent:s.readonly(D),setBeforeAuth:T,setOnSuccess:L,setOnEvent:M}}function R(e){const{appInfo:t,router:n,passkeyFeatures:a}=e;!function(){const e=new URLSearchParams(window.location.search);e.delete("code"),e.delete("link_account"),e.delete("provider_identifier"),e.delete("state");let t=window.location.pathname;0!==e.size&&(t+=`?${e.toString()}`);window.history.pushState({},document.title,t)}(),n.push(n.homeRoute,{appInfo:t,conditionalUI:a.conditionalUI,changeEmail:!0})}var U=(e=>(e.Email="email",e.SMS="sms",e.None="none",e))(U||{});function P(e){return e.auth_methods.otp?"sms":e.auth_methods.magic_link?"email":"none"}function O(e,t,n){return l(this,null,(function*(){var a,o;t.authState.linkingAccount=null!=(a=e.linkingAccount)&&a,t.authState.socialLogin=null!=(o=e.linkingAccount)&&o;const{passkeyFeatures:i,appInfo:r,router:l}=t,{emitEvent:c}=q(),{identifier:u,identifierType:p,webauthnTypes:f,emailVerified:v,phoneVerified:m,userID:g}=e,y=P(r)===U.None;if(0===f.length&&y)return void l.push(Ja);const h=f.includes(s.W.Passkey),k=f.includes(s.W.Platform),b=f.includes(s.W.SecurityKey),B=function(e,t,n,a){if(e.require_identifier_verification&&(a===d.email&&!t||a===d.phone&&!n))return!0;return!1}(r,v,m,p),V=i.platform&&k&&n.credIDExists(g),w=(i.syncedCredential||i.crossDeviceCredential)&&h,I=i.securityKey&&b,N=i.platform&&y,_=h&&i.platform&&!navigator.credentials.get.toString().includes("[native code]");!B&&(w||V||I||N||_)?(A().onEvent.value(C.onVerifyIdentity),l.push(Ha,{identifier:u,identifierType:p,appInfo:r,userIsVerifying:e.linkingAccount})):c({type:z.EmailOrSMSAuth,payload:{identifier:u,identifierType:p,userInitiated:!1,identifierVerifying:B||e.linkingAccount,setupNewDevice:i.platform}})}))}function F(e,t){const{authState:n,appInfo:a,router:o}=t;switch(n.userInitiatedFallback=e.userInitiated,P(a)){case U.SMS:!function(e){const{identifier:t,userIsRegistering:n}=e;n?A().onEvent.value(C.onOneTimePasscodeRegister,{identifier:t}):A().onEvent.value(C.onOneTimePasscodeLogin)}(e),o.push(qa,e);break;case U.Email:!function(e){const{identifier:t,userIsRegistering:n}=e;n?A().onEvent.value(C.onMagicLinkRegister,{identifier:t}):A().onEvent.value(C.onMagicLinkLogin)}(e),o.push(Wa,e);break;case U.None:o.push(Za)}}function j(e,t,n){return l(this,null,(function*(){if(u(e.authResult.auth_token)||u(e.authResult.redirect_url))return;const{socialLogin:a,linkingAccount:o}=t.authState;o&&(yield function(e){return l(this,null,(function*(){const t=window.location.search,n=new URLSearchParams(t).get("code");null!==n&&""!==n&&" "!==n?yield e.getCurrentUser().linkSocialAccount(n):console.error("Failed to link social account to existing account")}))}(n)),a||(yield function(e,t,n){return l(this,null,(function*(){if(n&&"string"==typeof n)return void localStorage.setItem("psg_last_login",n);let a=n;if(void 0===n)try{a=yield t.getCurrentUser().userInfo()}catch(i){console.error("Failed to fetch current user, auth token likely missing or invalid",i)}if(void 0===a)return;let o="";switch(e.allowed_identifier){case s.ue.email:o=a.email;break;case s.ue.phone:o=a.phone;break;case s.ue.both:o=a.email?a.email:a.phone}localStorage.setItem("psg_last_login",o)}))}(t.appInfo,n,e.identifier)),A().onSuccess.value(e.authResult)}))}var z=(e=>(e.CreatedUser="CreatedUser",e.ChangeIdentifier="ChangeIdentifier",e.LoginUser="LoginUser",e.EmailOrSMSAuth="EmailOrSMSAuth",e.AuthSuccess="AuthSuccess",e.EmailOrSMSAuthSuccess="EmailOrSMSAuthSuccess",e.SocialAuthEvent="SocialAuthEvent",e))(z||{});class ${constructor(e,t,n){this.appInfo=e,this.router=t,this.passage=n,this.authState={userInitiatedFallback:!1,socialLogin:!1,linkingAccount:!1},this.authOriginValid=!1,this.passkeyFeatures={securityKey:!1,platform:!1,syncedCredential:!1,crossDeviceCredential:!1,conditionalUI:!1,isAvailable:!1}}initializeEventHandler(){return l(this,null,(function*(){void 0!==this.appInfo.auth_methods.passkeys&&(this.authOriginValid=this.passage.checkWebauthnConfig(this.appInfo),this.authOriginValid&&(this.passkeyFeatures=yield this.passage.getCredentialAvailable(),function(){var e;const t=new s.UAParser;return(null==(e=t.getBrowser().name)?void 0:e.toLowerCase().includes("safari"))&&parseFloat(t.getBrowser().version||"")<16.4}()&&(this.passkeyFeatures.conditionalUI=!1)));const e=this.checkMagicLink(),t=this.checkSocialLogin();e||t||this.router.push(this.router.homeRoute,{appInfo:this.appInfo,conditionalUI:this.passkeyFeatures.conditionalUI})}))}handleEvent(e){return l(this,null,(function*(){switch(e.type){case"CreatedUser":!function(e,t){const{appInfo:n,router:a,passkeyFeatures:o}=t,{identifier:i,identifierType:r}=e,{emitEvent:l}=q();o.securityKey&&!n.require_identifier_verification?(A().onEvent.value(C.onRegisterDevice,{identifier:i}),a.push(Ga,{identifier:i,identifierType:r,appInfo:n,passkeyFeatures:o})):l({type:z.EmailOrSMSAuth,payload:{identifier:i,identifierType:r,identifierVerifying:n.require_identifier_verification,userIsRegistering:!0,userInitiated:!1}})}(e.payload,this.eventHandlerState);break;case"ChangeIdentifier":R(this.eventHandlerState);break;case"LoginUser":O(e.payload,this.eventHandlerState,this.passage);break;case"EmailOrSMSAuth":F(e.payload,this.eventHandlerState);break;case"AuthSuccess":j(e.payload,this.eventHandlerState,this.passage);break;case"EmailOrSMSAuthSuccess":!function(e,t){const{webauthnAllowed:n,authState:a,router:o}=t;!n||a.userInitiatedFallback||a.linkingAccount?q().emitEvent({type:z.AuthSuccess,payload:e}):o.push(Ya,e)}(e.payload,this.eventHandlerState);break;case"SocialAuthEvent":!function(e,t){l(this,null,(function*(){const{emitEvent:n}=q(),a=window.location.search,o=new URLSearchParams(a),i=o.get("code"),r=o.get("link_account"),l=o.get("provider_identifier");if(null!==i&&null!==r&&null!==l)if(e.authState.socialLogin=!0,"true"!==r)try{const e=yield t.finishSocialAuthentication(i);n({type:z.AuthSuccess,payload:{authResult:e}})}catch(s){const e=s;console.error("Exchanging social token for Passage token failed:",e.message),n({type:z.ChangeIdentifier,payload:void 0})}else e.router.push(Qa,{identifier:l,code:i});else n({type:z.ChangeIdentifier,payload:void 0})}))}(this.eventHandlerState,this.passage)}}))}get eventHandlerState(){return{appInfo:this.appInfo,webauthnAllowed:this.passkeyFeatures.platform,router:this.router,authState:this.authState,passkeyFeatures:this.passkeyFeatures}}checkMagicLink(){const e=window.location.search,t=new URLSearchParams(e);let n=null;return t.has("psg_magic_link")?n=t.get("psg_magic_link"):t.has("psg_verify_link")&&(n=t.get("psg_verify_link")),null!==n&&(this.router.push(Ka,{magicLink:n,webauthnAllowed:this.passkeyFeatures.platform}),!0)}checkSocialLogin(){const e=window.location.search,t=new URLSearchParams(e);return!!(t.has("code")&&t.has("state")&&t.has("link_account")&&t.has("provider_identifier"))&&(this.handleEvent({type:"SocialAuthEvent",payload:void 0}),!0)}}let G;function W(e,t,n){return l(this,null,(function*(){G=new $(e,t,n),yield G.initializeEventHandler()}))}function H(){return G}function K(e){return l(this,null,(function*(){return null==G?void 0:G.handleEvent(e)}))}function q(){return{initEventHandler:W,getEventHandler:H,emitEvent:K}}const Y=s.defineComponent({__name:"Login",props:{canToggleLoginRegister:{type:Boolean},identifier:{},countryCode:{},appInfo:{},visible:{type:Boolean},conditionalUI:{type:Boolean},changeEmail:{type:Boolean}},emits:["update:identifier","update:countryCode"],setup(e,{emit:t}){const n=e,{t:a}=s.useLocale(),{passage:o}=s.usePassage(),i=s.ref(""),r=s.computed((()=>Object.keys(n.appInfo.auth_methods).length>0)),c=s.computed({get:()=>n.identifier,set(e){t("update:identifier",e)}}),u=s.computed({get:()=>n.countryCode,set(e){t("update:countryCode",e)}}),p=s.ref();s.watch(p,(()=>l(this,null,(function*(){A().onEvent.value(C.onLoaded),y()}))));const f=s.computed((()=>{var e;return null!=(e=n.appInfo.allowed_identifier)?e:s.ue.email}));function v(e){return l(this,null,(function*(){const{identifier:t,identifierExists:o,userStatus:r,userID:l,identifierType:c,emailVerified:u,phoneVerified:p,webauthnTypes:f}=e;if(!A().beforeAuth.value(t))return;const v=function(e,t,o){if(!e){let e=t===d.email?a("email"):a("phone");e=`${e.charAt(0).toUpperCase()}${e.slice(1)}`;let o=`${a("not-recognized",[e])}.`;return n.canToggleLoginRegister&&n.appInfo.public_signup&&(o=`${o} ${a("toggle-register")}`),o}if(e&&o===s.re.INACTIVE)return a("account-no-longer-active");return""}(o,c,r);""===v?q().emitEvent({type:z.LoginUser,payload:{identifier:t,identifierType:c,userID:l,emailVerified:u,phoneVerified:p,webauthnTypes:f}}):i.value=v}))}const m=s.ref(!1);let g;function y(){return l(this,null,(function*(){n.conditionalUI&&(g=new AbortController,o.loginConditional(g.signal).then((e=>{q().emitEvent({type:z.AuthSuccess,payload:{authResult:e}})})).catch((()=>{})))}))}function h(){null==g||g.abort()}return s.onMounted((()=>{const e=localStorage.getItem("psg_last_login");e&&!n.changeEmail&&(c.value=e,m.value=!0)})),s.onBeforeUnmount((()=>{h()})),s.watch((()=>n.visible),(()=>{!0===m.value&&(c.value=""),m.value=!1,n.visible?y():h()})),(e,t)=>r.value?(s.openBlock(),s.createBlock(I,{key:0,identifierMode:f.value,conditionalUI:e.conditionalUI,showWelcomeBack:m.value,"onUpdate:showWelcomeBack":t[0]||(t[0]=e=>m.value=e),identifier:c.value,"onUpdate:identifier":t[1]||(t[1]=e=>c.value=e),validationError:i.value,"onUpdate:validationError":t[2]||(t[2]=e=>i.value=e),countryCode:u.value,"onUpdate:countryCode":t[3]||(t[3]=e=>u.value=e),onOnSubmit:t[4]||(t[4]=e=>v(e)),ref_key:"inputForm",ref:p},{loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},8,["identifierMode","conditionalUI","showWelcomeBack","identifier","validationError","countryCode"])):s.createCommentVNode("",!0)}}),Z={key:0},J={key:0,class:"notification is-danger has-text-centered","data-test":"invalid-app-id"},Q=s.defineComponent({__name:"Register",props:{canToggleLoginRegister:{type:Boolean},identifier:{},countryCode:{},appInfo:{}},emits:["update:identifier","update:countryCode","authEvent"],setup(e,{emit:t}){const n=e,{t:a}=s.useLocale(),{passage:o}=s.usePassage(),{emitEvent:i}=q(),r=s.ref(""),u=s.computed((()=>Object.keys(n.appInfo.auth_methods).length>0)),p=s.computed({get:()=>n.identifier,set(e){t("update:identifier",e)}}),f=s.computed({get:()=>n.countryCode,set(e){t("update:countryCode",e)}}),v=s.computed((()=>n.appInfo.public_signup)),m=s.computed((()=>n.appInfo.allowed_identifier));const g=s.ref({}),y=s.ref();return(e,t)=>u.value?(s.openBlock(),s.createElementBlock("div",Z,[s.createVNode(I,{identifierMode:m.value,identifier:p.value,"onUpdate:identifier":t[0]||(t[0]=e=>p.value=e),validationError:r.value,"onUpdate:validationError":t[1]||(t[1]=e=>r.value=e),countryCode:f.value,"onUpdate:countryCode":t[2]||(t[2]=e=>f.value=e),onOnSubmit:t[3]||(t[3]=e=>function(e){return l(this,null,(function*(){const{identifier:t,identifierExists:l,userStatus:u,identifierType:p}=e;if(!A().beforeAuth.value(t))return;let f=!0;if(y.value&&(f=y.value.validate()),l){if(u===s.re.ACTIVE){let e=a("account-already-exists",[p===d.email?a("email"):a("phone-number")]);return n.canToggleLoginRegister&&(e=e+" "+a("toggle-login")),void(r.value=e)}if(u===s.re.INACTIVE)return void(r.value=a("account-no-longer-active"))}if(f){try{yield o.createUser({identifier:t,user_metadata:c.transformMetadata(g.value,n.appInfo.user_metadata_schema,!0)})}catch(v){return void(v instanceof s.h&&v.message.startsWith("Public signup")?r.value=v.message:r.value=a("unexpected-error"))}i({type:z.CreatedUser,payload:{identifier:t,identifierType:p}})}}))}(e))},{metadataFields:s.withCtx((()=>[e.appInfo&&e.appInfo.layouts.registration.length>0?(s.openBlock(),s.createBlock(c.UserMetadata,{key:0,isEditing:!0,appInfo:e.appInfo,layoutType:s.unref(c.LayoutType).Registration,userMetadata:g.value,ref_key:"metadataComponent",ref:y},null,8,["appInfo","layoutType","userMetadata"])):s.createCommentVNode("",!0)])),_:1},8,["identifierMode","identifier","validationError","countryCode"]),v.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",J,s.toDisplayString(s.unref(a)("public-registration-not-allowed")),1))])):s.createCommentVNode("",!0)}}),X={key:0,class:"link has-text-centered"},ee={class:"passage-branding"},te={href:"https://passage.1password.com/",target:"_new_tab"},ne=s.defineComponent({__name:"PassageBranding",props:{appInfo:{}},setup:e=>(e,t)=>e.appInfo.passage_branding?(s.openBlock(),s.createElementBlock("div",X,[s.createBaseVNode("div",ee,[s.createBaseVNode("a",te,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).poweredByPassage,alt:"Powered by Passage Icon"},null,8,["src"])])])])):s.createCommentVNode("",!0)}),ae=["onClick"],oe=s.defineComponent({__name:"SocialAuthButton",props:{connection:{}},setup(e){const t=e,{t:n}=s.useLocale(),{theme:a}=s.useTheme(),{passage:o}=s.usePassage(),i=s.computed((()=>{switch(a.value){case s.Theme.Dark:return c.socialConnectionMetadata[t.connection].icons.dark;case s.Theme.Light:default:return c.socialConnectionMetadata[t.connection].icons.light}})),r=s.computed((()=>n("continue-with-social",[n(c.socialConnectionMetadata[t.connection].nameKey)]))),u=s.computed((()=>`${n(c.socialConnectionMetadata[t.connection].nameKey)} icon`));function d(){return l(this,null,(function*(){try{o.authorizeWith(t.connection)}catch(e){const t=e;t.statusCode===s.b.PSGSecureContextRequired?console.error(t.message):console.error("An unkown error occured while attempting to login with a social account.")}}))}return(e,t)=>(s.openBlock(),s.createElementBlock("button",{class:"button is-social",onClick:s.withModifiers(d,["prevent"])},[s.createVNode(s.unref(s.InlineSvg),{class:"social-button-icon",src:i.value,alt:u.value},null,8,["src","alt"]),s.createBaseVNode("span",null,s.toDisplayString(r.value),1)],8,ae))}}),ie={key:0,class:"social-button-spacer"},re=s.defineComponent({__name:"SocialAuthButtonList",props:{appInfo:{}},setup(e){const t=e,n=s.computed((()=>Object.keys(t.appInfo.social_connections).filter((e=>Object.keys(c.socialConnectionMetadata).includes(e)))));return(e,t)=>(s.openBlock(!0),s.createElementBlock(s.Fragment,null,s.renderList(n.value,((e,t)=>(s.openBlock(),s.createElementBlock("div",{class:"flex-column flex-center",key:e},[s.createVNode(oe,{connection:e},null,8,["connection"]),t!==n.value.length-1?(s.openBlock(),s.createElementBlock("div",ie)):s.createCommentVNode("",!0)])))),128))}}),le={key:0,class:"spacer-tall"},se={key:1,class:"social-login-divider"},ce=s.createBaseVNode("hr",{class:"divider-line"},null,-1),ue={class:"divider-text"},de=s.createBaseVNode("hr",{class:"divider-line"},null,-1),pe={key:2,class:"spacer-tall"},fe=s.defineComponent({__name:"SocialAuth",props:{appInfo:{}},setup(e){const t=e,{t:n}=s.useLocale(),a=s.computed((()=>Object.keys(t.appInfo.social_connections))),o=s.computed((()=>{const e=Object.keys(t.appInfo.auth_methods).length>0,n=a.value.length>0;return e&&n}));return(e,t)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[o.value?(s.openBlock(),s.createElementBlock("div",le)):s.createCommentVNode("",!0),o.value?(s.openBlock(),s.createElementBlock("div",se,[ce,s.createBaseVNode("span",ue,s.toDisplayString(s.unref(n)("or")),1),de])):s.createCommentVNode("",!0),o.value?(s.openBlock(),s.createElementBlock("div",pe)):s.createCommentVNode("",!0),s.createVNode(re,{"app-info":e.appInfo},null,8,["app-info"])],64))}}),ve={class:"view-email-input auth-flex-container"},me={class:"auth-flex-container"},ge={class:"title main-title has-text-centered"},ye=s.createBaseVNode("div",{style:{height:"20px"}},null,-1),he=s.createBaseVNode("div",{class:"spacer-tall"},null,-1),ke={class:"link has-text-centered"},be={key:0},Be=["onClick"],Ve={key:1},we=["onClick"],Ie=s.defineComponent({__name:"AuthView",props:{register:{type:Boolean},appInfo:{},conditionalUI:{type:Boolean},changeEmail:{type:Boolean}},setup(e){const t=e,{t:n}=s.useLocale(),a=s.ref(!t.register),o=s.ref(""),{defaultCountryCode:i}=s.useDefaultCountryCode(),r=i,l=s.computed((()=>t.appInfo.public_signup));function c(){a.value=!a.value}return(e,t)=>(s.openBlock(),s.createElementBlock("div",ve,[s.createBaseVNode("div",me,[s.createBaseVNode("div",ge,s.toDisplayString(a.value?s.unref(n)("login-title"):s.unref(n)("register-title")),1),ye,s.withDirectives(s.createVNode(Y,{identifier:o.value,"onUpdate:identifier":t[0]||(t[0]=e=>o.value=e),canToggleLoginRegister:!0,countryCode:s.unref(r),"onUpdate:countryCode":t[1]||(t[1]=e=>s.isRef(r)?r.value=e:null),appInfo:e.appInfo,visible:a.value,conditionalUI:e.conditionalUI,changeEmail:e.changeEmail},{loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},8,["identifier","countryCode","appInfo","visible","conditionalUI","changeEmail"]),[[s.vShow,a.value]]),s.withDirectives(s.createVNode(Q,{identifier:o.value,"onUpdate:identifier":t[2]||(t[2]=e=>o.value=e),canToggleLoginRegister:!0,countryCode:s.unref(r),"onUpdate:countryCode":t[3]||(t[3]=e=>s.isRef(r)?r.value=e:null),appInfo:e.appInfo},null,8,["identifier","countryCode","appInfo"]),[[s.vShow,!a.value]]),s.createVNode(fe,{"app-info":e.appInfo},null,8,["app-info"]),he,s.createBaseVNode("div",ke,[a.value&&l.value?(s.openBlock(),s.createElementBlock("div",be,[s.createTextVNode(s.toDisplayString(s.unref(n)("dont-have-an-account"))+" ",1),s.createBaseVNode("a",{onClick:s.withModifiers(c,["prevent"]),role:"button",class:"body-link","data-test":"register-link"},s.toDisplayString(s.unref(n)("register-here")),9,Be)])):a.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",Ve,[s.createTextVNode(s.toDisplayString(s.unref(n)("already-have-an-account"))+" ",1),s.createBaseVNode("a",{onClick:s.withModifiers(c,["prevent"]),role:"button",class:"body-link","data-test":"login-link"},s.toDisplayString(s.unref(n)("login-here")),9,we)]))])]),s.createVNode(ne,{"app-info":e.appInfo},null,8,["app-info"])]))}});var Ce=(e=>(e.LOGIN="psg_magic_link",e.VERIFY="psg_verify_link",e))(Ce||{});const Ne=({magicLink:e,uiState:t,magicLinkUtils:n,passage:a})=>{const o=s.ref(null),i=()=>{t.uiLoading(),o.value={auth_token:"",redirect_url:""}},r=()=>{t.uiError()},c=()=>{n.invalidMagicLink.value=!0,t.uiError()},u=e=>l(this,[e],(function*({webauthnAllowed:e,magicLinkAction:n,result:a}){o.value=a,e&&n!==Ce.VERIFY||(t.uiSuccess(),yield new Promise((e=>{setTimeout(e,2e3)}))),o.value.redirect_url&&q().emitEvent({type:n===Ce.VERIFY?z.AuthSuccess:z.EmailOrSMSAuthSuccess,payload:{authResult:a}})}));return{authResult:o,onBeforeActivate:i,onActivateError:r,onActivateErrorInvalidMagicLink:c,onActivateSuccess:u,activateWithoutBiometrics:(t,n)=>l(this,null,(function*(){i();try{const o=yield a.magicLinkActivate(e);u({webauthnAllowed:t,magicLinkAction:n,result:o})}catch(o){o.statusCode===s.b.NotFound?c():r()}}))}},_e={class:"auth-flex-container"},Se={class:"image has-text-centered",style:{"margin-top":"16px"}},xe={class:"has-text-centered","data-test":"activate-magic-link-message",style:{"margin-top":"8px","margin-bottom":"40px"}},Ee={key:0},De={key:1},Te={key:2},Le={key:3},Me={key:4},Ae={key:0,class:"flex-row flex-center"},Re=["onClick","disabled"],Ue={key:0},Pe={key:1},Oe={key:2},Fe=s.defineComponent({__name:"ActivateMagicLink",props:{magicLink:{},webauthnAllowed:{type:Boolean}},setup(e){const t=e,{t:n}=s.useLocale(),{passage:a}=s.usePassage(),o=function(){const e=s.ref(!1),t=s.ref(!1),n=s.ref(!1),a=s.ref(!0),{t:o}=s.useLocale(),i=s.computed((()=>t.value?o("success"):e.value?o("something-went-wrong"):o("log-in-with-a-passkey")));return{showFailure:e,showSuccess:t,loading:n,pageLoading:a,title:i,uiSuccess:()=>{t.value=!0,e.value=!1,n.value=!1},uiError:()=>{t.value=!1,e.value=!0,n.value=!1},uiLoading:()=>{t.value=!1,e.value=!1,n.value=!0}}}(),{showFailure:i,showSuccess:r,loading:c,pageLoading:u,title:d}=o,p=(e=>{const t=s.ref(),n=s.ref(!1);return{magicLinkAction:t,invalidMagicLink:n,isMagicLinkValid:()=>{const a=new URLSearchParams(window.location.href.split("?")[1]);return a.has("psg_magic_link")?t.value="psg_magic_link":a.has("psg_verify_link")&&(t.value="psg_verify_link"),t.value&&e||(n.value=!0),!n.value}}})(t.magicLink),{isMagicLinkValid:f,invalidMagicLink:v,magicLinkAction:m}=p,g=Ne({uiState:o,magicLinkUtils:p,passage:a,magicLink:t.magicLink});function y(){v.value?window.location.href=window.location.href.split("?")[0]:g.activateWithoutBiometrics(t.webauthnAllowed,m.value)}return s.onMounted((()=>l(this,null,(function*(){f()?(yield g.activateWithoutBiometrics(t.webauthnAllowed,m.value),A().onEvent.value(C.onMagicLinkActivateSuccess)):o.uiError(),u.value=!1})))),(e,t)=>(s.openBlock(),s.createBlock(s.Transition,{name:"fade",mode:"out-in",appear:""},{default:s.withCtx((()=>[s.withDirectives(s.createBaseVNode("div",_e,[s.createBaseVNode("div",{class:s.normalizeClass(["title has-text-centered",[s.unref(r)?"main-title":"secondary-title"]])},s.toDisplayString(s.unref(i)?s.unref(v)?s.unref(n)("invalid-link"):s.unref(n)("device-login-failed-title"):s.unref(d)),3),s.createBaseVNode("figure",Se,[s.unref(r)?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,src:s.unref(s.Icons).success,alt:"Magic link success"},null,8,["src"])):s.unref(i)?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).failure,alt:"Magic link failure"},null,8,["src"])):s.createCommentVNode("",!0)]),s.createBaseVNode("div",xe,[s.unref(r)&&s.unref(m)===s.unref(Ce).LOGIN?(s.openBlock(),s.createElementBlock("div",Ee,s.toDisplayString(s.unref(n)("successfully-logged-in-redirect")),1)):s.unref(r)&&s.unref(m)===s.unref(Ce).VERIFY?(s.openBlock(),s.createElementBlock("div",De,s.toDisplayString(s.unref(n)("successfully-changed-email")),1)):s.unref(i)&&s.unref(v)&&s.unref(m)===s.unref(Ce).VERIFY?(s.openBlock(),s.createElementBlock("div",Te,s.toDisplayString(s.unref(n)("link-invalid")),1)):s.unref(i)&&s.unref(v)?(s.openBlock(),s.createElementBlock("div",Le,s.toDisplayString(s.unref(n)("login-link-invalid")),1)):s.unref(i)&&s.unref(m)===s.unref(Ce).VERIFY?(s.openBlock(),s.createElementBlock("div",Me,s.toDisplayString(s.unref(n)("verification-failed-please-try-again")),1)):s.createCommentVNode("",!0)]),s.unref(i)||s.unref(r)?(s.openBlock(),s.createElementBlock("div",Ae,[s.createBaseVNode("button",{onClick:s.withModifiers(y,["prevent"]),type:"button",class:s.normalizeClass(["button is-primary",{"is-loading":s.unref(c)}]),part:"button",disabled:s.unref(c),"data-test":"activate-magic-link-button"},[s.unref(i)&&s.unref(v)?(s.openBlock(),s.createElementBlock("span",Ue,s.toDisplayString(s.unref(n)("request-new-link")),1)):s.unref(i)?(s.openBlock(),s.createElementBlock("span",Pe,s.toDisplayString(s.unref(n)("try-again")),1)):s.unref(r)?(s.openBlock(),s.createElementBlock("span",Oe,s.toDisplayString(s.unref(n)("redirect-now")),1)):s.createCommentVNode("",!0)],10,Re)])):s.createCommentVNode("",!0)],512),[[s.vShow,!s.unref(u)]])])),_:1}))}}),je={class:"view-verify-token"},ze=s.defineComponent({__name:"ActivateMagicLinkView",props:{magicLink:{},webauthnAllowed:{type:Boolean}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",je,[s.createVNode(Fe,{magicLink:e.magicLink,webauthnAllowed:e.webauthnAllowed},null,8,["magicLink","webauthnAllowed"])]))}),$e={class:"view-email-input"},Ge=s.defineComponent({__name:"LoginView",props:{register:{type:Boolean},appInfo:{},conditionalUI:{type:Boolean},changeEmail:{type:Boolean}},setup(e){const t=s.ref(""),{defaultCountryCode:n}=s.useDefaultCountryCode(),a=n;return(e,n)=>(s.openBlock(),s.createElementBlock("div",$e,[s.createVNode(Y,{identifier:t.value,"onUpdate:identifier":n[0]||(n[0]=e=>t.value=e),countryCode:s.unref(a),"onUpdate:countryCode":n[1]||(n[1]=e=>s.isRef(a)?a.value=e:null),canToggleLoginRegister:!1,appInfo:e.appInfo,conditionalUI:e.conditionalUI,changeEmail:e.changeEmail},{loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},8,["identifier","countryCode","appInfo","conditionalUI","changeEmail"]),s.createVNode(fe,{"app-info":e.appInfo},null,8,["app-info"]),s.createVNode(ne,{"app-info":e.appInfo},null,8,["app-info"])]))}}),We={class:"view-email-input"},He=s.defineComponent({__name:"RegisterView",props:{register:{type:Boolean},appInfo:{}},setup(e){const t=s.ref(""),{defaultCountryCode:n}=s.useDefaultCountryCode(),a=n;return(e,n)=>(s.openBlock(),s.createElementBlock("div",We,[s.createVNode(Q,{identifier:t.value,"onUpdate:identifier":n[0]||(n[0]=e=>t.value=e),countryCode:s.unref(a),"onUpdate:countryCode":n[1]||(n[1]=e=>s.isRef(a)?a.value=e:null),canToggleLoginRegister:!1,appInfo:e.appInfo},null,8,["identifier","countryCode","appInfo"]),s.createVNode(fe,{"app-info":e.appInfo},null,8,["app-info"]),s.createVNode(ne,{"app-info":e.appInfo},null,8,["app-info"])]))}}),Ke=s.defineComponent({name:"Spinner"}),qe={class:"spinner-box"},Ye={class:"spinner-content"};var Ze=s._export_sfc(Ke,[["render",function(e,t,n,a,o,i){return s.openBlock(),s.createElementBlock("div",qe,[s.createBaseVNode("div",Ye,[s.renderSlot(e.$slots,"default")])])}]]);const Je={class:"auth-flex-container"},Qe={class:"title has-text-centered"},Xe={key:0,class:"content has-text-centered",style:{"margin-bottom":"40px !important"}},et=["innerHTML"],tt={class:"flex-row flex-center"},nt=["onClick","disabled"],at=s.createBaseVNode("div",{class:"spacer"},null,-1),ot={class:"link has-text-centered"},it=["onClick"],rt=s.defineComponent({__name:"MagicLink",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup(e){const t=e,{t:n,locale:a}=s.useLocale(),{passage:o}=s.usePassage(),{emitEvent:i}=q(),r=s.computed((()=>t.identifierType===d.email)),c=s.computed((()=>t.identifierVerifying?r.value?t.userIsRegistering?n("verify-email-to-register"):n("verify-email-to-login"):t.userIsRegistering?n("verify-phone-to-register"):n("verify-phone-to-login"):r.value?t.userIsRegistering?n("check-email-to-register"):n("check-email-to-login"):t.userIsRegistering?n("check-phone-to-register"):n("check-phone-to-login"))),u=s.computed((()=>{let e="";const a=t.identifierType===d.email?n("messagetype-email"):n("messagetype-sms"),o=t.identifierType===d.email?n("email"):n("phone-number"),i=t.userIsRegistering?n("registration"):n("login"),r=t.identifierVerifying?n("please-verify-identifier",[o,i]):n("you-will-be-automatically-signed-in");return e=n("weve-sent-messagetype",[a,t.identifier,r]),t.setupNewDevice&&!t.userIsRegistering&&(e=n("we-dont-recognize-this-device")+" "+e),e}));function p(){localStorage.removeItem("email"),localStorage.removeItem("magic_link_id"),localStorage.removeItem("wait_count"),b(721),i({type:z.ChangeIdentifier,payload:void 0})}function f(){return l(this,null,(function*(){yield g()}))}s.onMounted((()=>{t.userIsRegistering?function(){l(this,null,(function*(){v.value=!1,m.value=!0,yield new Promise((e=>{setTimeout(e,2e3)}));try{const e=yield o.newRegisterMagicLink(t.identifier,a.value.split("-")[0]);""!=e.id&&(localStorage.setItem("magic_link_id",e.id),b(0))}catch(e){console.log("magicLinkSend error",e)}finally{m.value=!1}}))}():g()}));const v=s.ref(!1),m=s.ref(!0);function g(){return l(this,null,(function*(){v.value=!1,m.value=!0;try{const e=yield o.newLoginMagicLink(t.identifier,a.value.split("-")[0]);""!=e.id&&(localStorage.setItem("magic_link_id",e.id),b(0))}catch(e){console.log("magicLinkSend error",e)}finally{yield new Promise((e=>{setTimeout(e,3e3)})),m.value=!1}}))}let y,h;function k(){return l(this,null,(function*(){const e=localStorage.getItem("magic_link_id");yield function(e){return l(this,null,(function*(){yield o.getMagicLinkStatus(e).then((e=>{b(721),y=e})).catch((()=>{}))}))}(e).then((()=>l(this,null,(function*(){y&&""!=y.redirect_url&&(localStorage.removeItem("magic_link_id"),localStorage.removeItem("wait_count"),A().onEvent.value(C.onMagicLinkActivated),i({type:z.EmailOrSMSAuthSuccess,payload:{identifier:t.identifier,authResult:y}}))}))))}))}function b(e){let t=e;if(!(t<720))return clearTimeout(h),void(v.value=!1);v.value=!0,h=setTimeout((()=>l(this,null,(function*(){!function(e){k(),localStorage.setItem("wait_count",e.toString())}(t),t++,b(t)}))),5e3)}return(e,t)=>(s.openBlock(),s.createElementBlock("div",Je,[s.createBaseVNode("div",Qe,[s.createBaseVNode("span",null,s.toDisplayString(c.value),1)]),s.createVNode(Ze,null,{default:s.withCtx((()=>[r.value?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,src:s.unref(s.Icons).email,alt:"Email envelope"},null,8,["src"])):(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).phone,alt:"Message bubbles"},null,8,["src"]))])),_:1}),u.value?(s.openBlock(),s.createElementBlock("div",Xe,[s.createBaseVNode("span",{innerHTML:u.value},null,8,et)])):s.createCommentVNode("",!0),s.createBaseVNode("div",tt,[s.createBaseVNode("button",{onClick:s.withModifiers(f,["prevent"]),type:"button",class:"button is-primary",part:"button",disabled:m.value},s.toDisplayString(s.unref(n)("resend-isemail-email-message",[r.value?s.unref(n)("email"):s.unref(n)("message")])),9,nt)]),at,s.createBaseVNode("div",ot,[s.createBaseVNode("a",{onClick:s.withModifiers(p,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(n)("change-isemail-email-phone",[r.value?s.unref(n)("email"):s.unref(n)("phone")])),9,it)])]))}}),lt={class:"view-access-token auth-flex-container"},st=s.defineComponent({__name:"MagicLinkView",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",lt,[s.createVNode(rt,{identifier:e.identifier,userIsRegistering:e.userIsRegistering,identifierVerifying:e.identifierVerifying,setupNewDevice:e.setupNewDevice,identifierType:e.identifierType},null,8,["identifier","userIsRegistering","identifierVerifying","setupNewDevice","identifierType"])]))}),ct={class:"passage-learnmore-modal"},ut={class:"passage-learnmore-top"},dt={class:"passage-learnmore-close-button"},pt={class:"passage-learnmore-content"},ft={style:{"margin-bottom":"32px"}},vt=s.defineComponent({__name:"LearnMoreLayout",setup(e){const{t:t}=s.useLocale(),n=s.ref(!1);return(e,a)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[n.value?(s.openBlock(),s.createElementBlock("div",{key:0,class:"passage-learnmore",onClick:a[1]||(a[1]=e=>n.value=!1)},[s.createBaseVNode("div",ct,[s.createBaseVNode("div",ut,[s.createBaseVNode("div",{style:{cursor:"pointer"},onClick:a[0]||(a[0]=e=>n.value=!1)},[s.createBaseVNode("span",dt,s.toDisplayString(s.unref(t)("close")),1),s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).close},null,8,["src"])])]),s.createBaseVNode("div",pt,[s.renderSlot(e.$slots,"body")])])])):s.createCommentVNode("",!0),s.createBaseVNode("div",null,[s.createBaseVNode("div",ft,[s.createBaseVNode("span",null,[s.renderSlot(e.$slots,"cta"),s.createTextVNode("   ")]),s.createBaseVNode("a",{style:{"text-decoration":"underline"},onClick:a[2]||(a[2]=e=>n.value=!0),role:"button"},s.toDisplayString(s.unref(t)("learn-more")),1),s.createTextVNode(" → ")])])],64))}}),mt={style:{"margin-bottom":"12px"}},gt={class:"passage-learnmore-header"},yt={class:"passage-learnmore-body"},ht={class:"passage-learnmore-header"},kt={class:"passage-learnmore-body"},bt={class:"passage-learnmore-header"},Bt={class:"passage-learnmore-body"},Vt=s.defineComponent({__name:"LearnMorePasskey",props:{cta:{}},setup(e){const{t:t}=s.useLocale();return(e,n)=>(s.openBlock(),s.createBlock(vt,null,{cta:s.withCtx((()=>[s.createBaseVNode("div",mt,s.toDisplayString(s.unref(t)("passkeys-are-a-simple")),1),s.createTextVNode(" "+s.toDisplayString(e.cta),1)])),body:s.withCtx((()=>[s.createBaseVNode("div",gt,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).privateIcon,style:{"margin-right":"8px"}},null,8,["src"]),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("private")),1)]),s.createBaseVNode("div",yt,s.toDisplayString(s.unref(t)("unlock-your-passkey")),1),s.createBaseVNode("div",ht,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).secure,style:{"margin-right":"8px"}},null,8,["src"]),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("secure")),1)]),s.createBaseVNode("div",kt,s.toDisplayString(s.unref(t)("passkey-is-unique")),1),s.createBaseVNode("div",bt,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).simple,style:{"margin-right":"8px"}},null,8,["src"]),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("simple")),1)]),s.createBaseVNode("div",Bt,s.toDisplayString(s.unref(t)("easy-to-use")),1)])),_:1}))}}),wt={class:"auth-flex-container","data-tag":"register-device-message"},It={class:"title secondary-title has-text-centered"},Ct={class:"image has-text-centered"},Nt={key:0},_t={key:1},St={key:1},xt={style:{"margin-bottom":"12px"}},Et={style:{"margin-bottom":"24px"}},Dt={key:2},Tt={style:{"margin-bottom":"32px"}},Lt={key:2,class:"flex-row flex-center"},Mt=["onClick","disabled"],At=["onClick","disabled"],Rt={key:3,class:"flex-column flex-center",style:{margin:"auto"}},Ut=["onClick","disabled"],Pt=["onClick","disabled"],Ot=s.createBaseVNode("div",{class:"spacer"},null,-1),Ft={key:4,class:"content has-text-centered",style:{"margin-top":"20px !important"}},jt={class:"link"},zt=["onClick"],$t={class:"link"},Gt=["onClick"],Wt={key:0,class:"link"},Ht=["onClick"],Kt=s.defineComponent({__name:"RegisterDevice",props:{identifier:{},identifierType:{},appInfo:{},passkeyFeatures:{}},setup(e){const t=e,n=s.ref(!1),a=s.ref(!1),{t:o,te:i}=s.useLocale(),{passage:r}=s.usePassage(),{emitEvent:c}=q(),{autofocusButton:u}=p(),f=s.computed((()=>t.passkeyFeatures.platform)),v=s.computed((()=>t.passkeyFeatures.securityKey)),m=s.computed((()=>t.identifierType===d.email)),g=s.computed((()=>P(t.appInfo))),y=s.computed((()=>g.value!==U.None)),h=s.computed((()=>g.value===U.SMS?i("register-with-code")?o("register-with-code"):"Register with a code":o("register-with-link",[m.value?o("email"):o("sms-text")]))),k=s.computed((()=>g.value===U.SMS?i("send-code")?o("send-code"):"Send code":o("send-email-or-text-link",[m.value?o("email"):o("sms-text")]))),b=s.computed((()=>{switch(g.value){case U.SMS:return i("passkey-create-fail-try-code")?o("passkey-create-fail-try-code"):"Unable to create a passkey. Try again or register with a one-time code.";case U.Email:return o("passkey-create-fail-try-link");case U.None:return o("passkey-create-fail-no-fallback")}}));let B=s.G.Platform;function V(e,o){return l(this,null,(function*(){a.value=!0;try{B=o;const n=yield r.register(e,{authenticatorAttachment:o});a.value=!1,c({type:z.AuthSuccess,payload:{authResult:n,identifier:t.identifier}})}catch(i){n.value=!0,a.value=!1}}))}function w(){c({type:z.EmailOrSMSAuth,payload:{identifier:t.identifier,identifierType:t.identifierType,userIsRegistering:!0,userInitiated:!0}})}function I(){localStorage.removeItem("email"),q().emitEvent({type:z.ChangeIdentifier,payload:void 0})}function C(){!0===f.value?V(t.identifier,s.G.Platform):V(t.identifier,s.G.CrossPlatform)}function N(){V(t.identifier,s.G.CrossPlatform)}function _(){V(t.identifier,B)}return(e,t)=>(s.openBlock(),s.createElementBlock("div",wt,[s.createBaseVNode("div",It,s.toDisplayString(f.value?s.unref(o)("register-with-a-passkey"):s.unref(o)("register-passkey-another-device")),1),s.createBaseVNode("figure",Ct,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkey,alt:"Register with a passkey"},null,8,["src"])]),n.value?(s.openBlock(),s.createElementBlock("div",Nt,[s.createBaseVNode("p",null,s.toDisplayString(b.value),1)])):(s.openBlock(),s.createElementBlock("div",_t,[f.value&&!v.value?(s.openBlock(),s.createBlock(Vt,{key:0,cta:s.unref(o)("register-your-account")},null,8,["cta"])):s.createCommentVNode("",!0),f.value&&v.value?(s.openBlock(),s.createElementBlock("div",St,[s.createBaseVNode("div",xt,s.toDisplayString(s.unref(o)("passkeys-are-a-simple")),1),s.createBaseVNode("div",Et,s.toDisplayString(s.unref(o)("passkey-register-options")),1)])):s.createCommentVNode("",!0),!f.value&&v.value?(s.openBlock(),s.createElementBlock("div",Dt,[s.createBaseVNode("div",Tt,s.toDisplayString(s.unref(o)("passkeys-not-supported-try-another-device")),1)])):s.createCommentVNode("",!0)])),n.value?(s.openBlock(),s.createElementBlock("div",Lt,[s.createBaseVNode("button",{onClick:s.withModifiers(_,["prevent"]),type:"button",part:"button",class:"button is-primary",disabled:a.value,style:{"margin-right":"5px"}},s.toDisplayString(s.unref(o)("try-again")),9,Mt),y.value?(s.openBlock(),s.createElementBlock("button",{key:0,onClick:s.withModifiers(w,["prevent"]),type:"button",part:"button button-secondary",class:"button is-secondary",disabled:a.value,style:{"margin-left":"5px"},"data-test":"login-with-email-button",ref_key:"autofocusButton",ref:u},s.toDisplayString(k.value),9,At)):s.createCommentVNode("",!0)])):(s.openBlock(),s.createElementBlock("div",Rt,[s.createBaseVNode("button",{onClick:s.withModifiers(C,["prevent"]),type:"button",class:s.normalizeClass(["button",[{"is-loading":a.value}]]),part:"button",disabled:a.value,"data-test":"register-main-button",tabindex:"0",ref_key:"autofocusButton",ref:u,style:{margin:"8px 0px"}},[s.createBaseVNode("span",null,s.toDisplayString(f.value?s.unref(o)("register-with-passkey"):s.unref(o)("use-another-device")),1)],10,Ut),f.value&&v.value?(s.openBlock(),s.createElementBlock("button",{key:0,onClick:s.withModifiers(N,["prevent"]),type:"button",class:s.normalizeClass(["button is-secondary",[{"is-loading":a.value}]]),part:"button button-secondary",style:{width:"100%",margin:"8px 0px"},disabled:a.value,"data-test":"register-secondary-button",tabindex:"0",ref_key:"autofocusButton",ref:u},[s.createBaseVNode("span",null,s.toDisplayString(s.unref(o)("use-another-device")),1)],10,Pt)):s.createCommentVNode("",!0)])),Ot,n.value?(s.openBlock(),s.createElementBlock("div",Ft,[s.createBaseVNode("div",jt,[s.createBaseVNode("a",{onClick:s.withModifiers(I,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(o)("change-isemail-email-phone",[m.value?s.unref(o)("email"):s.unref(o)("phone")])),9,zt)])])):s.createCommentVNode("",!0),n.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",{key:5,class:s.normalizeClass(["flex-row flex-wrap",y.value?"flex-between":"flex-center"])},[s.createBaseVNode("div",$t,[s.createBaseVNode("a",{onClick:s.withModifiers(I,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(o)("back")),9,Gt)]),y.value?(s.openBlock(),s.createElementBlock("div",Wt,[s.createBaseVNode("a",{onClick:s.withModifiers(w,["prevent"]),role:"button","data-test":"register-email-button"},s.toDisplayString(h.value),9,Ht)])):s.createCommentVNode("",!0)],2))]))}}),qt=s.defineComponent({__name:"RegisterDeviceView",props:{identifier:{},identifierType:{},appInfo:{},passkeyFeatures:{}},setup(e){const t=e;return(e,n)=>(s.openBlock(),s.createBlock(Kt,s.normalizeProps(s.guardReactiveProps(t)),null,16))}}),Yt={class:"auth-flex-container"},Zt={class:"title has-text-centered"},Jt={class:"image has-text-centered",style:{"margin-top":"8px"}},Qt={key:1,class:"wrap-text",style:{"margin-bottom":"5px !important"}},Xt={"data-test":"failure-message"},en={style:{margin:"0px","margin-top":"8px","margin-bottom":"40px"}},tn={key:2,class:"flex-row flex-center"},nn=["onClick","disabled"],an=["onClick","disabled"],on=s.createBaseVNode("div",{class:"spacer"},null,-1),rn={key:3,class:"content has-text-centered",style:{"margin-top":"20px !important"}},ln={class:"link"},sn=["onClick"],cn={class:"link"},un=["onClick"],dn={key:0,class:"link"},pn=["onClick"],fn=s.defineComponent({__name:"WebauthnSignIn",props:{identifier:{},identifierType:{},appInfo:{},userIsVerifying:{type:Boolean}},setup(e){const t=e,n=s.ref(!1),a=s.ref(!1),{t:o,te:i}=s.useLocale(),{passage:r}=s.usePassage(),{emitEvent:c}=q(),u=s.computed((()=>t.userIsVerifying?o("verify-account"):o("log-in-with-a-passkey"))),f=s.computed((()=>t.identifierType===d.email)),{autofocusButton:v}=p(),m=s.computed((()=>P(t.appInfo))),g=s.computed((()=>m.value!==U.None)),y=s.computed((()=>m.value===U.SMS?i("send-code")?o("send-code"):"Send code":o("send-email-or-text-link",[f.value?o("email"):o("sms-text")]))),h=s.computed((()=>m.value===U.SMS?i("login-with-code")?o("login-with-code"):"Login with a code":o("login-with-link",[f.value?o("email"):o("sms-text")]))),k=s.computed((()=>{switch(m.value){case U.SMS:return i("passkey-login-fail-try-code")?o("passkey-login-fail-try-code"):"Unable to log in with a passkey. Try again or log in with a one-time code.";case U.Email:return o("passkey-login-fail-try-link");case U.None:return o("passkey-login-fail-no-fallback")}}));function b(){return l(this,null,(function*(){if(n.value=!1,t.identifier){a.value=!0;try{const e=yield r.login(t.identifier);c({type:z.AuthSuccess,payload:{authResult:e,identifier:t.identifier}}),a.value=!1}catch(e){const o=e;n.value=!0,a.value=!1,o.statusCode===s.b.PSGParsePublicKeyForLoginFailed?n.value=!0:c({type:z.EmailOrSMSAuth,payload:{identifier:t.identifier,identifierType:t.identifierType,userInitiated:!1}})}}}))}function B(){c({type:z.EmailOrSMSAuth,payload:{identifier:t.identifier,identifierType:t.identifierType,userInitiated:!0}})}function V(){localStorage.removeItem("email"),c({type:z.ChangeIdentifier,payload:void 0})}return s.onMounted((()=>{b()})),(e,t)=>(s.openBlock(),s.createElementBlock("div",Yt,[s.createBaseVNode("div",Zt,s.toDisplayString(u.value),1),s.createBaseVNode("figure",Jt,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkey,alt:"Log in with a passkey",style:{margin:"5px"}},null,8,["src"])]),n.value?n.value?(s.openBlock(),s.createElementBlock("div",Qt,[s.createBaseVNode("div",Xt,[s.createBaseVNode("p",en,s.toDisplayString(k.value),1)])])):s.createCommentVNode("",!0):(s.openBlock(),s.createBlock(Vt,{key:0,cta:s.unref(o)("log-into-your-account")},null,8,["cta"])),n.value?(s.openBlock(),s.createElementBlock("div",tn,[s.createBaseVNode("button",{onClick:s.withModifiers(b,["prevent"]),type:"button",part:"button",class:"button is-primary",disabled:a.value,style:{"margin-right":"5px"}},s.toDisplayString(s.unref(o)("try-again")),9,nn),g.value?(s.openBlock(),s.createElementBlock("button",{key:0,onClick:s.withModifiers(B,["prevent"]),type:"button",part:"button button-secondary",class:"button is-secondary",disabled:a.value,style:{"margin-left":"5px"},"data-test":"login-with-email-button",ref_key:"autofocusButton",ref:v},s.toDisplayString(y.value),9,an)):s.createCommentVNode("",!0)])):s.createCommentVNode("",!0),on,n.value?(s.openBlock(),s.createElementBlock("div",rn,[s.createBaseVNode("div",ln,[s.createBaseVNode("a",{onClick:s.withModifiers(V,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(o)("change-isemail-email-phone",[f.value?s.unref(o)("email"):s.unref(o)("phone")])),9,sn)])])):s.createCommentVNode("",!0),n.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",{key:4,class:s.normalizeClass(["flex-row flex-wrap",g.value?"flex-between":"flex-center"])},[s.createBaseVNode("div",cn,[s.createBaseVNode("a",{onClick:s.withModifiers(V,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(o)("back")),9,un)]),g.value?(s.openBlock(),s.createElementBlock("div",dn,[s.createBaseVNode("a",{onClick:s.withModifiers(B,["prevent"]),role:"button","data-test":"register-email-button"},s.toDisplayString(h.value),9,pn)])):s.createCommentVNode("",!0)],2))]))}}),vn={class:"view-webauthn-sign-in auth-flex-container"},mn=s.defineComponent({__name:"WebauthnSignInView",props:{identifier:{},identifierType:{},appInfo:{},userIsVerifying:{type:Boolean}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",vn,[s.createVNode(fn,{identifier:e.identifier,identifierType:e.identifierType,appInfo:e.appInfo,userIsVerifying:e.userIsVerifying},null,8,["identifier","identifierType","appInfo","userIsVerifying"])]))}),gn={style:{display:"flex","align-items":"center"},class:"psg-otp-single-input-container"},yn=["data-test","type","inputtype","placeholder","inputmode","disabled","maxlength","autocomplete"],hn={key:0},kn=["innerHTML"],bn=s.defineComponent({__name:"OneTimePasscodeSingleInput",props:{conditionalClass:{},focus:{type:Boolean},inputClasses:{default:()=>[]},inputmode:{default:"numeric"},inputType:{default:"number"},isDisabled:{type:Boolean},isLastChild:{type:Boolean},placeholder:{},separator:{default:""},shouldAutoFocus:{type:Boolean,default:!1},value:{default:""},isFirstChild:{type:Boolean},inputIdx:{},inputCount:{}},emits:["on-change","on-keydown","on-paste","on-focus","on-blur"],setup(e,{emit:t}){const n=e,a=s.ref(n.value||""),o=s.ref(null),i=s.computed((()=>"letter-numeric"===n.inputType?"text":n.inputType)),r=()=>(a.value=a.value.toString(),a.value.length>1&&(a.value=a.value.slice(0,1)),t("on-change",a.value)),l=e=>{n.isDisabled&&e.preventDefault();const a=e||window.event,o=a.which?a.which:a.keyCode;(e=>e>=48&&e<=57||e>=96&&e<=105)(o)||"letter-numeric"===n.inputType&&(e=>e>=65&&e<=90)(o)||[8,9,13,37,39,46,86].includes(o)?t("on-keydown",e):a.preventDefault()},c=e=>t("on-paste",e),u=()=>(o.value.select(),t("on-focus")),d=()=>t("on-blur");return s.watch((()=>n.value),((e,t)=>{e!==t&&(a.value=e)})),s.watch((()=>n.focus),((e,t)=>{t!==e&&o.value&&n.focus&&(o.value.focus(),o.value.select())})),s.onMounted((()=>{o.value&&n.focus&&n.shouldAutoFocus&&(o.value.focus(),o.value.select())})),(e,t)=>(s.openBlock(),s.createElementBlock("div",gn,[s.withDirectives(s.createBaseVNode("input",{"data-test":`otp-single-input-${e.inputIdx}`,type:i.value,inputtype:i.value,placeholder:e.placeholder,inputmode:e.inputmode,disabled:e.isDisabled,ref_key:"input",ref:o,pattern:"[0-9]*",maxlength:e.isFirstChild?e.inputCount:1,min:"0",max:"9","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:s.normalizeClass(["psg-input","psg-otp-input",[...e.inputClasses||[]]]),onInput:r,onKeydown:l,onPaste:c,onFocus:u,onBlur:d,autocomplete:e.isFirstChild?"one-time-code":"off"},null,42,yn),[[s.vModelDynamic,a.value]]),!e.isLastChild&&e.separator?(s.openBlock(),s.createElementBlock("span",hn,[s.createBaseVNode("span",{innerHTML:e.separator},null,8,kn)])):s.createCommentVNode("",!0)]))}}),Bn={style:{display:"flex","justify-content":"space-between"},class:"psg-otp-input-container"},Vn={key:0,autocomplete:"off",name:"hidden",type:"text",style:{display:"none"}},wn=s.defineComponent({__name:"OneTimePasscodeInput",props:{value:{default:""},numInputs:{default:6},separator:{default:""},inputClasses:{},conditionalClass:{default:()=>[]},inputType:{default:"number"},inputmode:{default:"numeric"},shouldAutoFocus:{type:Boolean,default:!1},placeholder:{default:()=>[]},isDisabled:{type:Boolean,default:!1},disableNonCurrent:{type:Boolean,default:!1}},emits:["update:value","on-complete","on-change"],setup(e,{emit:t}){const n=e,a=s.ref(0),o=s.ref([]),i=s.ref([]);s.watch((()=>n.value),(e=>{const t=(s.unref(e)||"").padEnd(n.numInputs," ").split("");o.value=t}),{immediate:!0});const r=()=>{a.value=-1},l=e=>{a.value=Math.max(Math.min(n.numInputs-1,e),0)},c=()=>{n.disableNonCurrent?setTimeout((()=>{l(a.value+1)}),200):l(a.value+1)},u=()=>{l(a.value-1)},d=e=>{i.value=Object.assign([],o.value),o.value[a.value]=e,i.value.join("")!==o.value.join("")&&(t("update:value",o.value.join("")),t("on-change",o.value.join("")))},p=e=>{var i;e.preventDefault();const r=null==(i=e.clipboardData)?void 0:i.getData("text/plain").slice(0,n.numInputs-a.value).split("");if("number"===n.inputType&&!(null==r?void 0:r.join("").match(/^\d+$/)))return"Invalid pasted data";if("letter-numeric"===n.inputType&&!(null==r?void 0:r.join("").match(/^\w+$/)))return"Invalid pasted data";const s=o.value.slice(0,a.value).concat(r||"");return s.slice(0,n.numInputs).forEach(((e,t)=>{o.value[t]=e})),l(s.slice(0,n.numInputs).length),o.value.join("").length===n.numInputs?(t("update:value",o.value.join("")),t("on-complete",o.value.join(""))):"Wait until the user enters the required number of characters"},f=e=>{d(e),c()},v=e=>{switch(e.keyCode){case 8:e.preventDefault(),d(""),u();break;case 46:e.preventDefault(),d("");break;case 37:e.preventDefault(),u();break;case 39:e.preventDefault(),c()}};return(e,t)=>(s.openBlock(),s.createElementBlock("div",Bn,["password"===e.inputType?(s.openBlock(),s.createElementBlock("input",Vn)):s.createCommentVNode("",!0),(s.openBlock(!0),s.createElementBlock(s.Fragment,null,s.renderList(e.numInputs,((t,n)=>(s.openBlock(),s.createBlock(bn,{key:n,focus:a.value===n,value:o.value[n],separator:e.separator,"input-type":e.inputType,inputmode:e.inputmode,"input-classes":e.inputClasses,conditionalClass:e.conditionalClass[n],"is-last-child":n===e.numInputs-1,"is-first-child":0===n,"should-auto-focus":e.shouldAutoFocus,placeholder:e.placeholder[n],"is-disabled":e.isDisabled||e.disableNonCurrent&&n>o.value.join("").trim().length,"input-idx":n,"input-count":e.numInputs,onOnChange:f,onOnKeydown:v,onOnPaste:p,onOnFocus:e=>{return t=n,void(a.value=t);var t},onOnBlur:r},null,8,["focus","value","separator","input-type","inputmode","input-classes","conditionalClass","is-last-child","is-first-child","should-auto-focus","placeholder","is-disabled","input-idx","input-count","onOnFocus"])))),128))]))}}),In={class:"auth-flex-container"},Cn={class:"flex flex-column",style:{"flex-grow":"1"}},Nn={class:"title has-text-centered"},_n={class:"content wrap-text"},Sn={style:{"margin-top":"32px","margin-bottom":"40px"}},xn=["innerHTML"],En={class:"flex flex-row flex-center"},Dn={class:"flex-row",style:{"margin-top":"8px"}},Tn={class:"error-message",style:{"min-height":"17px"}},Ln={class:"flex-row flex-center",style:{"margin-top":"16px"}},Mn=["onClick","disabled"],An=s.createBaseVNode("div",{class:"spacer"},null,-1),Rn={class:"flex-row flex-wrap flex-between"},Un={class:"link"},Pn=["onClick"],On={class:"link"},Fn=["onClick"],jn=s.defineComponent({__name:"OneTimePasscode",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup(e){const t=e,{t:n,te:a,locale:o}=s.useLocale(),i=s.ref(!0),r=s.ref(void 0),c=s.ref(!1),u=s.ref(!1),d=s.ref(void 0),p=s.ref(void 0),f=s.computed((()=>t.identifierVerifying?n("verify-account"):n("enter-code"))),v=s.computed((()=>a("enter-code-sent")?n("enter-code-sent",[t.identifier]):`A one-time code has been sent to <span style="font-weight: 700;">${t.identifier}</span>. Enter the code here to log in.`)),m=s.computed((()=>a("back")?n("back"):"Back")),g=s.computed((()=>a("resend-code")?n("resend-code"):"Resend code")),y=s.computed((()=>c.value?["has-error"]:[])),h=s.computed((()=>false)),k=s.computed((()=>i.value));s.watch(r,(()=>{var e;S(),6===(null==(e=r.value)?void 0:e.trim().length)&&V()}));const{passage:b}=s.usePassage(),B=(e=!1)=>l(this,null,(function*(){_(),S(),x(),i.value=!0;try{const n=e?yield b.newRegisterOneTimePasscode(t.identifier,o.value.split("-")[0]):yield b.newLoginOneTimePasscode(t.identifier,o.value.split("-")[0]);""!=n.otp_id&&(localStorage.setItem("otp_id",n.otp_id),p.value=n.otp_id)}catch(r){E(a("code-send-error")?n("code-send-error"):"An error occurred sending the code.",!0)}finally{i.value=!1}})),V=()=>l(this,null,(function*(){_(),S(),i.value=!0;try{if(!r.value)throw new Error("Login code is undefined.");if(6!==r.value.length)throw new Error("Login code is invalid length.");if(!p.value)throw new Error("Login code id is undefined.");const e=yield b.oneTimePasscodeActivate(r.value,p.value);e&&""!=e.redirect_url&&(localStorage.removeItem("otp_id"),A().onEvent.value(C.onOneTimePasscodeActivated),q().emitEvent({type:z.EmailOrSMSAuthSuccess,payload:{identifier:t.identifier,authResult:e}}))}catch(e){e.statusCode===s.b.Unauthorized?E(n("otp-limit-error")):E(n("code-invalid-or-expired"))}finally{i.value=!1}})),w=()=>{q().emitEvent({type:z.ChangeIdentifier,payload:void 0})},I=()=>{B()},N=()=>{V()};s.onMounted((()=>{B(t.userIsRegistering),function(){const e=D.value.getRootNode().host;D.value.appendChild(function(){const e=document.createElement("style");return e.appendChild(document.createTextNode("\n      .psg-otp-input-container{\n        margin: 0px;\n        padding: 0px;\n        align-items: center;\n        height: auto;\n        width: auto;\n      }\n      .psg-otp-single-input-container{\n        margin: 0px;\n        padding: 0px;\n        height: auto;\n        width: auto;\n      }\n      .psg-otp-input {\n        width: 40px;\n        height: 40px;\n        padding: 0px;\n        margin-left: 4px;\n        margin-right: 4px;\n        font-size: 24px;\n        font-weight: 400;\n        color: var(--passage-input-text-color, var(--passage-body-text-color-default));\n        font-family: var(--passage-body-font-family, var(--passage-body-font-family-default));\n        line-height: 29px;\n        border-radius: 4px;\n        border: 1px solid transparent;\n        text-align: center;\n        background-color: var(--passage-otp-input-background-color, var(--passage-otp-input-background-color-default));\n        -moz-appearance: textfield;\n      }\n      .psg-otp-input:read-only {\n        background-color: var(--passage-otp-input-background-color, var(--passage-otp-input-background-color-default));\n      }\n      .psg-otp-input::-webkit-inner-spin-button{\n        -webkit-appearance: none;\n        display: none;\n        margin: 0;\n      }\n      .psg-otp-input::-webkit-outer-spin-button{\n        -webkit-appearance: none;\n        display: none;\n        margin: 0;\n      }\n      .psg-input.has-error{\n        border-color: var(--passage-error-color, var(--passage-error-color-default)) !important;\n      }\n      .psg-input.is-danger {\n        border-color: var(--passage-error-color, var(--passage-error-color-default)) !important;\n      }\n      .psg-input:focus {\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-control-border-active-color, var(--passage-control-border-active-color-default));\n      }\n      .psg-input:active {\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-control-border-active-color, var(--passage-control-border-active-color-default));\n      }")),e}()),e.appendChild(D.value)}()})),s.onBeforeUnmount((()=>{D.value.remove()}));const _=()=>{i.value=!0},S=()=>{d.value=void 0,c.value=!1,u.value=!1},x=()=>{r.value=void 0},E=(e,t=!1)=>{d.value=e,c.value=!t,u.value=t},D=s.ref();return(e,t)=>(s.openBlock(),s.createElementBlock("div",In,[s.createBaseVNode("form",Cn,[s.createBaseVNode("div",Nn,[s.createBaseVNode("span",null,s.toDisplayString(f.value),1)]),s.createBaseVNode("div",_n,[s.createBaseVNode("div",Sn,[s.createBaseVNode("p",{innerHTML:v.value},null,8,xn)])]),s.createBaseVNode("div",En,[s.createBaseVNode("div",{ref_key:"otpInput",ref:D,slot:"otpInput"},[s.createVNode(wn,{"num-inputs":6,"is-disabled":h.value,value:r.value,"onUpdate:value":t[0]||(t[0]=e=>r.value=e),"input-classes":y.value,"disable-non-current":!1},null,8,["is-disabled","value","input-classes"])],512),s.renderSlot(e.$slots,"otpInput")]),s.createBaseVNode("div",Dn,[s.createBaseVNode("div",Tn,s.toDisplayString(d.value?d.value:" "),1)]),s.createBaseVNode("div",Ln,[s.createBaseVNode("button",{type:"submit",class:"button is-primary",part:"button","data-test":"continue-button",onClick:s.withModifiers(N,["prevent"]),disabled:k.value},s.toDisplayString(s.unref(n)("continue")),9,Mn)]),An,s.createBaseVNode("div",Rn,[s.createBaseVNode("div",Un,[s.createBaseVNode("a",{onClick:s.withModifiers(w,["prevent"]),role:"button","data-test":"one-time-passcode-goback-button"},s.toDisplayString(m.value),9,Pn)]),s.createBaseVNode("div",On,[s.createBaseVNode("a",{onClick:s.withModifiers(I,["prevent"]),role:"button","data-test":"one-time-passcode-resend-button"},s.toDisplayString(g.value),9,Fn)])])])]))}}),zn={class:"view-access-token auth-flex-container"},$n=s.defineComponent({__name:"OneTimePasscodeView",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",zn,[s.createVNode(jn,{identifier:e.identifier,userIsRegistering:e.userIsRegistering,identifierVerifying:e.identifierVerifying,setupNewDevice:e.setupNewDevice,identifierType:e.identifierType},{otpInput:s.withCtx((()=>[s.renderSlot(e.$slots,"otpInput")])),_:3},8,["identifier","userIsRegistering","identifierVerifying","setupNewDevice","identifierType"])]))}),Gn={class:"title has-text-centered secondary-title","data-test":"activate-magic-link-message"},Wn={class:"image has-text-centered",style:{"margin-bottom":"32px"}},Hn={key:0,class:"has-text-centered",style:{"margin-bottom":"32px"}},Kn={class:"flex-row flex-center",style:{"margin-bottom":"64px"}},qn=["onClick","disabled"],Yn={key:0},Zn={key:1},Jn={key:2,class:"link has-text-centered"},Qn=["onClick"],Xn=s.defineComponent({__name:"AddDevice",props:{authResult:{},identifier:{}},setup(e){const t=e,{t:n}=s.useLocale(),a=s.ref(!1),o=s.ref(!1),i=s.ref(),{addDevice:r,addPending:c}=s.useAddDevice(),{autofocusButton:u}=p(),d=s.computed((()=>a.value?n("something-went-wrong"):n("add-passkey")));function f(){return l(this,null,(function*(){var e;i.value=yield r(),(null==(e=i.value)?void 0:e.id)?(o.value=!0,a.value=!1,v()):(a.value=!0,o.value=!1)}))}const v=()=>{q().emitEvent({type:z.AuthSuccess,payload:{identifier:t.identifier,authResult:t.authResult}})};return(e,t)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[s.createBaseVNode("div",Gn,s.toDisplayString(d.value),1),s.createBaseVNode("figure",Wn,[a.value?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,src:s.unref(s.Icons).failure,alt:"Device failure"},null,8,["src"])):(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).passkey,alt:"Add a passkey"},null,8,["src"]))]),a.value?(s.openBlock(),s.createElementBlock("div",Hn,s.toDisplayString(s.unref(n)("failed-to-add-this-device")),1)):(s.openBlock(),s.createBlock(Vt,{key:1,cta:s.unref(n)("log-into-your-account")},null,8,["cta"])),s.createBaseVNode("div",Kn,[s.createBaseVNode("button",{onClick:s.withModifiers(f,["prevent"]),type:"button",class:s.normalizeClass(["button is-primary",{"is-loading":s.unref(c)}]),part:"button",disabled:s.unref(c),"data-test":"save-device-button",ref_key:"autofocusButton",ref:u},[a.value?(s.openBlock(),s.createElementBlock("span",Yn,s.toDisplayString(s.unref(n)("try-again")),1)):(s.openBlock(),s.createElementBlock("span",Zn,s.toDisplayString(s.unref(n)("add-passkey")),1))],10,qn)]),o.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",Jn,[s.createBaseVNode("div",null,[s.createBaseVNode("a",{onClick:s.withModifiers(v,["prevent"]),role:"button","data-test":"add-device-skip"},s.toDisplayString(s.unref(n)("skip")),9,Qn)])]))],64))}}),ea={class:"view-add-device"},ta=s.defineComponent({__name:"AddDeviceView",props:{authResult:{},identifier:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",ea,[s.createVNode(Xn,{authResult:e.authResult,identifier:e.identifier},null,8,["authResult","identifier"])]))}),na={class:"wrap-text",style:{"margin-bottom":"12px !important"}},aa={class:"passage-learnmore-header"},oa={class:"passage-learnmore-body"},ia={class:"passage-learnmore-header"},ra={class:"passage-learnmore-body"},la=s.defineComponent({__name:"LearnMoreDisabledFallbacks",setup(e){const{t:t}=s.useLocale();return(e,n)=>(s.openBlock(),s.createBlock(vt,null,{cta:s.withCtx((()=>[s.createBaseVNode("div",na,s.toDisplayString(s.unref(t)("passkeys-are-required"))+s.toDisplayString(" "),1),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("try-again-on-device-with-passkeys")),1)])),body:s.withCtx((()=>[s.createBaseVNode("div",aa,s.toDisplayString(s.unref(t)("what-are-passkeys")),1),s.createBaseVNode("div",oa,s.toDisplayString(s.unref(t)("passkeys-are-a-simpler-and-more-secure-alternative")),1),s.createBaseVNode("div",ia,s.toDisplayString(s.unref(t)("devices-that-support-passkeys")),1),s.createBaseVNode("div",ra,s.toDisplayString(s.unref(t)("devices-with-a-biometric-sensor-are-likely-to-support-passkeys")),1)])),_:1}))}}),sa={class:"auth-flex-container"},ca={class:"title has-text-centered"},ua={class:"image has-text-centered"},da=s.createBaseVNode("div",{class:"spacer"},null,-1),pa={class:"flex-row flex-wrap flex-center"},fa={class:"link"},va=["onClick"],ma=s.defineComponent({__name:"DisableFallbacks",setup(e){const{t:t}=s.useLocale(),{emitEvent:n}=q();function a(){localStorage.removeItem("email"),n({type:z.ChangeIdentifier,payload:void 0})}return(e,n)=>(s.openBlock(),s.createElementBlock("div",sa,[s.createBaseVNode("div",ca,s.toDisplayString(s.unref(t)("device-not-supported")),1),s.createBaseVNode("figure",ua,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkeyArrow,alt:"Device not supported"},null,8,["src"])]),s.createVNode(la),da,s.createBaseVNode("div",pa,[s.createBaseVNode("div",fa,[s.createBaseVNode("a",{onClick:s.withModifiers(a,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(t)("back")),9,va)])])]))}}),ga=s.defineComponent({__name:"DisableFallbackView",setup:e=>(e,t)=>(s.openBlock(),s.createBlock(ma))}),ya={class:"auth-flex-container"},ha={class:"title has-text-centered"},ka={class:"image has-text-centered"},ba={class:"wrap-text",style:{"margin-bottom":"12px !important"}},Ba={class:"wrap-text"},Va=s.createBaseVNode("div",{class:"spacer"},null,-1),wa={class:"flex-row flex-wrap flex-center"},Ia={class:"link"},Ca=["onClick"],Na=s.defineComponent({__name:"LoginNotSupported",setup(e){const{t:t}=s.useLocale(),{emitEvent:n}=q();function a(){localStorage.removeItem("email"),n({type:z.ChangeIdentifier,payload:void 0})}return(e,n)=>(s.openBlock(),s.createElementBlock("div",ya,[s.createBaseVNode("div",ha,s.toDisplayString(s.unref(t)("login-not-supported")),1),s.createBaseVNode("figure",ka,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkeyArrow,alt:"Device not supported"},null,8,["src"])]),s.createBaseVNode("div",ba,s.toDisplayString(s.unref(t)("passkeys-are-now-required")),1),s.createBaseVNode("div",Ba,s.toDisplayString(s.unref(t)("please-contact-support-to-regain-access")),1),Va,s.createBaseVNode("div",wa,[s.createBaseVNode("div",Ia,[s.createBaseVNode("a",{onClick:s.withModifiers(a,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(t)("back")),9,Ca)])])]))}}),_a=s.defineComponent({__name:"LoginNotSupportedView",setup:e=>(e,t)=>(s.openBlock(),s.createBlock(Na))}),Sa={class:"auth-flex-container flex-center"},xa={class:"title has-text-centered"},Ea={class:"flex-column flex-center",style:{"margin-bottom":"32px"}},Da={key:2},Ta={style:{"margin-bottom":"40px"}},La=["onClick"],Ma=["onClick"],Aa=s.createBaseVNode("div",{class:"spacer"},null,-1),Ra={key:2,class:"link has-text-centered"},Ua=["onClick"],Pa=s.defineComponent({__name:"LinkAccount",props:{identifier:{},code:{}},setup(e){const t=e,{t:n}=s.useLocale(),{theme:a}=s.useTheme(),{emitEvent:o}=q(),{passage:i}=s.usePassage(),r=s.ref(!1),u=sessionStorage.getItem("oauth2Connection"),d=c.socialConnectionMetadata[u],p=s.computed((()=>r.value?n("link-account-failed"):n("link-your-account-to-social-provider",[n(null!=u?u:"")]))),f=s.computed((()=>`${n(d.nameKey)} icon`)),v=s.computed((()=>r.value?n("session-invalid"):n("found-existing-account",[n(null!=u?u:"")]))),m=s.computed((()=>{switch(a.value){case s.Theme.Dark:return d.icons.dark;case s.Theme.Light:default:return d.icons.light}}));function g(){o({type:z.ChangeIdentifier,payload:void 0})}function y(){return l(this,null,(function*(){try{const e=yield i.finishSocialAuthentication(t.code);o({type:z.AuthSuccess,payload:{authResult:e}})}catch(e){const t=e;console.error(t.message),r.value=!0}}))}return(e,t)=>(s.openBlock(),s.createElementBlock("form",Sa,[s.createBaseVNode("div",xa,[s.createBaseVNode("span",null,s.toDisplayString(p.value),1)]),s.createBaseVNode("div",Ea,[r.value?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).failure,class:"link-account-failed",alt:"Account link failure"},null,8,["src"])):(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,class:"link-account-icon",src:m.value,alt:f.value},null,8,["src","alt"])),r.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",Da,[s.createBaseVNode("strong",null,s.toDisplayString(e.identifier),1)]))]),s.createBaseVNode("div",Ta,s.toDisplayString(v.value),1),r.value?(s.openBlock(),s.createElementBlock("button",{key:1,class:"button is-primary",onClick:s.withModifiers(g,["prevent"])},s.toDisplayString(s.unref(n)("return-to-login")),9,Ma)):(s.openBlock(),s.createElementBlock("button",{key:0,class:"button is-primary",onClick:s.withModifiers(y,["prevent"])},s.toDisplayString(s.unref(n)("link-account")),9,La)),Aa,r.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",Ra,[s.createBaseVNode("a",{onClick:s.withModifiers(g,["prevent"]),role:"button"},s.toDisplayString(s.unref(n)("cancel")),9,Ua)]))]))}}),Oa={class:"link-account auth-flex-container"},Fa=s.defineComponent({__name:"LinkAccountView",props:{identifier:{},code:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",Oa,[s.createVNode(Pa,{identifier:e.identifier,code:e.code},null,8,["identifier","code"])]))}),ja={component:Ie},za={component:Ge},$a={component:He},Ga={component:qt},Wa={component:st},Ha={component:mn},Ka={component:ze},qa={component:$n},Ya={component:ta},Za={component:ga},Ja={component:_a},Qa={component:Fa},Xa={passage_container_background_color:"--passage-container-background-color-default",passage_container_max_width:"--passage-container-max-width-default",passage_input_box_background_color:"--passage-input-box-background-color-default",passage_input_box_border_radius:"--passage-input-box-border-radius-default",passage_header_font_family:"--passage-header-font-family-default",passage_body_font_family:"--passage-body-font-family-default",passage_header_text_color:"--passage-header-text-color-default",passage_body_text_color:"--passage-body-text-color-default",passage_primary_button_background_color:"--passage-primary-button-background-color-default",passage_primary_button_text_color:"--passage-primary-button-text-color-default",passage_primary_button_hover_color:"--passage-primary-button-background-hover-color-default",passage_primary_button_border_radius:"--passage-primary-button-border-radius-default",passage_primary_button_border_color:"--passage-primary-button-border-color-default",passage_primary_button_border_width:"--passage-primary-button-border-width-default",passage_secondary_button_background_color:"--passage-secondary-button-background-color-default",passage_secondary_button_text_color:"-passage-secondary-button-text-color-default",passage_secondary_button_hover_color:"--passage-secondary-button-background-hover-color-default",passage_secondary_button_border_radius:"--passage-secondary-button-border-radius-default",passage_secondary_button_border_color:"--passage-secondary-button-border-color-default",passage_secondary_button_border_width:"--passage-secondary-button-border-width-default"},eo={passage_container_max_width:"passage_container_max_width",passage_input_box_border_radius:"passage_input_box_border_radius",passage_primary_button_border_radius:"passage_primary_button_border_radius",passage_primary_button_border_width:"passage_primary_button_border_width",passage_secondary_button_border_radius:"passage_secondary_button_border_radius",passage_secondary_button_border_width:"passage_secondary_button_border_width"};class to{constructor(e){this._homeRoute=ja,this._history=[],void 0!==e&&(this._homeRoute=e)}get homeRoute(){return this._homeRoute}set homeRoute(e){this._homeRoute=e}get currentRoute(){if(0!==this._history.length)return this._history[this._history.length-1]}push(e,l){var s;this._history.push((s=((e,t)=>{for(var n in t||(t={}))o.call(t,n)&&r(e,n,t[n]);if(a)for(var n of a(t))i.call(t,n)&&r(e,n,t[n]);return e})({},e),t(s,n({props:l}))))}resetRouter(){this._history=[]}}const no={class:"debug-router"},ao=s.createBaseVNode("div",{class:"section-label"},"View",-1),oo=s.createBaseVNode("div",{class:"section-label"},"Props",-1),io={key:0},ro=s.createBaseVNode("div",{class:"control-label"},"Identifier",-1),lo=s.createBaseVNode("div",{class:"control-label"},"Identifier Type",-1),so={key:1},co=s.createBaseVNode("div",{class:"control-label"},"Identifier",-1),uo=s.createBaseVNode("div",{class:"control-label"},"Identifier Type",-1),po=s.createBaseVNode("div",{class:"control-label"},"User Is Verifying",-1),fo={key:2},vo=s.createBaseVNode("div",{class:"control-label"},"Identifier",-1),mo=s.createBaseVNode("div",{class:"control-label"},"Identifier Type",-1),go=s.createBaseVNode("div",{class:"control-label"},"Setup New Device",-1),yo=s.createBaseVNode("div",{class:"control-label"},"User Is Registering",-1),ho=s.createBaseVNode("div",{class:"control-label"},"Verifying Identifier",-1),ko={key:3},bo=s.createBaseVNode("div",{class:"control-label"},"Identifier",-1),Bo=s.createBaseVNode("div",{class:"control-label"},"Identifier Type",-1),Vo=s.createBaseVNode("div",{class:"control-label"},"Setup New Device",-1),wo=s.createBaseVNode("div",{class:"control-label"},"User Is Registering",-1),Io=s.createBaseVNode("div",{class:"control-label"},"Verifying Identifier",-1),Co={key:4},No=s.createBaseVNode("div",{class:"control-label"},"Identifier",-1),_o=s.createBaseVNode("div",{class:"control-label"},"Social Connection",-1),So=s.createBaseVNode("div",{class:"control-label"},"Code",-1),xo={key:5},Eo=s.createBaseVNode("div",{class:"control-label"},"Magic Link",-1),Do={key:6},To=["onClick"],Lo="authenticator@passage.id",Mo=(s.defineComponent({__name:"DebugRouter",props:{router:{},appInfo:{}},setup(e){const t=e,n=s.ref([{name:"Main View",value:{route:t.router.homeRoute,key:"MAINVIEW"}},{name:"Register Device",value:{route:Ga,key:"REGISTERDEVICE"}},{name:"Webauthnn Login",value:{route:Ha,key:"WEBAUTHNSIGNIN"}},{name:"One Time Passcode",value:{route:qa,key:"OTP"}},{name:"Magic Link",value:{route:Wa,key:"MAGICLINK"}},{name:"Activate Magic Link",value:{route:Ka,key:"ACTIVATEMAGICLINK"}},{name:"Add Device",value:{route:Ya,key:"ADDDEVICE"}},{name:"Device Not Supported",value:{route:Za,key:"DEVICENOTSUPPORTED"}},{name:"Login Not Supported",value:{route:Ja,key:"LOGINNOTSUPPORTED"}},{name:"Link Account",value:{route:Qa,key:"LINKACCOUNT"}}]),a=s.ref(n.value[0].value),{passage:o}=s.usePassage();o.getCredentialAvailable().then((e=>l.passkeyFeatures=e)),o.getCurrentSession().getAuthToken().then((e=>{m.authResult.auth_token=e})).catch((()=>{}));const i=[{name:"Email",value:d.email},{name:"Phone",value:d.phone}],r=s.reactive({register:!1,appInfo:t.appInfo}),l=s.reactive({identifier:Lo,identifierType:d.email,appInfo:t.appInfo,passkeyFeatures:{securityKey:!0,platform:!0,syncedCredential:!0,crossDeviceCredential:!0,conditionalUI:!0,isAvailable:!0}}),u=s.reactive({identifier:Lo,identifierType:d.email,appInfo:t.appInfo,userIsVerifying:!1}),p=s.reactive({identifier:Lo,identifierType:d.email,setupNewDevice:!1,userIsRegistering:!1,identifierVerifying:!1}),f=s.reactive({identifier:Lo,identifierType:d.email,setupNewDevice:!1,userIsRegistering:!1,identifierVerifying:!1}),v=s.reactive({magicLink:"",webauthnAllowed:!0}),m=s.reactive({authResult:{redirect_url:t.appInfo.redirect_url,auth_token:""}}),g=s.reactive({identifier:Lo,code:"1234"}),y=s.ref(s.de.Google),h=[{name:"Google",value:s.de.Google},{name:"Github",value:s.de.Github}];function k(){let e;switch(a.value.key){case"MAINVIEW":e=r;break;case"REGISTERDEVICE":e=l;break;case"WEBAUTHNSIGNIN":e=u;break;case"OTP":e=p;break;case"MAGICLINK":e=f;break;case"ACTIVATEMAGICLINK":e=v;break;case"ADDDEVICE":e=m;break;case"LINKACCOUNT":e=g,sessionStorage.setItem("oauth2Connection",y.value);break;case"DEVICENOTSUPPORTED":case"LOGINNOTSUPPORTED":e=void 0}t.router.push(a.value.route,e)}return(e,t)=>(s.openBlock(),s.createElementBlock("div",no,[ao,s.createVNode(s.Dropdown,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),items:n.value},null,8,["modelValue","items"]),oo,"REGISTERDEVICE"===a.value.key?(s.openBlock(),s.createElementBlock("div",io,[ro,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.identifier=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,l.identifier]]),lo,s.createVNode(s.Dropdown,{modelValue:l.identifierType,"onUpdate:modelValue":t[2]||(t[2]=e=>l.identifierType=e),items:i},null,8,["modelValue"])])):"WEBAUTHNSIGNIN"===a.value.key?(s.openBlock(),s.createElementBlock("div",so,[co,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>u.identifier=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,u.identifier]]),uo,s.createVNode(s.Dropdown,{modelValue:u.identifierType,"onUpdate:modelValue":t[4]||(t[4]=e=>u.identifierType=e),items:i},null,8,["modelValue"]),po,s.createVNode(c.Checkbox,{modelValue:u.userIsVerifying,"onUpdate:modelValue":t[5]||(t[5]=e=>u.userIsVerifying=e)},null,8,["modelValue"])])):"OTP"===a.value.key?(s.openBlock(),s.createElementBlock("div",fo,[vo,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>p.identifier=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,p.identifier]]),mo,s.createVNode(s.Dropdown,{modelValue:p.identifierType,"onUpdate:modelValue":t[7]||(t[7]=e=>p.identifierType=e),items:i},null,8,["modelValue"]),go,s.createVNode(c.Checkbox,{modelValue:p.setupNewDevice,"onUpdate:modelValue":t[8]||(t[8]=e=>p.setupNewDevice=e)},null,8,["modelValue"]),yo,s.createVNode(c.Checkbox,{modelValue:p.userIsRegistering,"onUpdate:modelValue":t[9]||(t[9]=e=>p.userIsRegistering=e)},null,8,["modelValue"]),ho,s.createVNode(c.Checkbox,{modelValue:p.identifierVerifying,"onUpdate:modelValue":t[10]||(t[10]=e=>p.identifierVerifying=e)},null,8,["modelValue"])])):"MAGICLINK"===a.value.key?(s.openBlock(),s.createElementBlock("div",ko,[bo,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>f.identifier=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,f.identifier]]),Bo,s.createVNode(s.Dropdown,{modelValue:f.identifierType,"onUpdate:modelValue":t[12]||(t[12]=e=>f.identifierType=e),items:i},null,8,["modelValue"]),Vo,s.createVNode(c.Checkbox,{modelValue:f.setupNewDevice,"onUpdate:modelValue":t[13]||(t[13]=e=>f.setupNewDevice=e)},null,8,["modelValue"]),wo,s.createVNode(c.Checkbox,{modelValue:f.userIsRegistering,"onUpdate:modelValue":t[14]||(t[14]=e=>f.userIsRegistering=e)},null,8,["modelValue"]),Io,s.createVNode(c.Checkbox,{modelValue:f.identifierVerifying,"onUpdate:modelValue":t[15]||(t[15]=e=>f.identifierVerifying=e)},null,8,["modelValue"])])):"LINKACCOUNT"===a.value.key?(s.openBlock(),s.createElementBlock("div",Co,[No,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>g.identifier=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,g.identifier]]),_o,s.createVNode(s.Dropdown,{modelValue:y.value,"onUpdate:modelValue":t[17]||(t[17]=e=>y.value=e),items:h},null,8,["modelValue"]),So,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[18]||(t[18]=e=>g.code=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,g.code]])])):"ACTIVATEMAGICLINK"===a.value.key?(s.openBlock(),s.createElementBlock("div",xo,[Eo,s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[19]||(t[19]=e=>v.magicLink=e),type:"text",class:"input psg-input"},null,512),[[s.vModelText,v.magicLink]])])):(s.openBlock(),s.createElementBlock("div",Do,"None")),s.createBaseVNode("button",{class:"button",onClick:s.withModifiers(k,["prevent"]),style:{"margin-top":"16px"}},"Go To View",8,To)]))}}),s.defineComponent({__name:"DebugPanel",props:{router:{},appInfo:{}},setup(e){s.ref(),s.ref(!1);return(e,t)=>s.createCommentVNode("",!0)}})),Ao={key:1,class:"notification is-danger has-text-centered","data-test":"invalid-app-id"},Ro=s.defineComponent({__name:"SmartRouter",props:{homeRoute:{},authContainerRef:{},theme:{}},setup(e){const t=e,n=s.reactive(new to(t.homeRoute)),a=s.computed((()=>n.currentRoute)),{t:o}=s.useLocale(),{appInfo:i,loading:r,invalidAppId:c,passage:u}=s.useAppInfo(),{initEventHandler:d}=q(),{setCustomElementStyles:p}={setCustomElementStyles:(e,t,n)=>{const a=n===s.Theme.Light?t.element_customization:t.element_customization_dark;Object.entries(a).forEach((t=>{const[n,a]=t;let o=a;Object.values(eo).includes(n)&&(o=function(e){return`${e}px`}(a)),e.style.setProperty(Xa[n],o)}))}},f=s.computed((()=>{var e;return null==(e=a.value)?void 0:e.component})),v=s.computed((()=>{var e;const t=null==(e=a.value)?void 0:e.props;return void 0===t?{}:t})),m=s.ref(!1);return s.watch(i,(()=>l(this,null,(function*(){m.value=!1,void 0!==i.value&&void 0!==u.value&&(yield d(i.value,n,u.value),m.value=!0,t.authContainerRef&&p(t.authContainerRef,i.value,t.theme))})))),s.onUpdated((()=>{void 0!==i.value&&null!==t.authContainerRef&&p(t.authContainerRef,i.value,t.theme)})),(e,t)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[s.createVNode(s.Transition,{name:"fade",mode:"out-in",appear:""},{default:s.withCtx((()=>[!s.unref(r)&&m.value?(s.openBlock(),s.createBlock(s.resolveDynamicComponent(f.value),s.normalizeProps(s.mergeProps({key:0},v.value)),{otpInput:s.withCtx((()=>[s.renderSlot(e.$slots,"otpInput")])),loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},16)):s.createCommentVNode("",!0)])),_:3}),s.unref(i)&&m.value?(s.openBlock(),s.createBlock(Mo,{key:0,router:n,"app-info":s.unref(i)},null,8,["router","app-info"])):s.createCommentVNode("",!0),s.unref(c)?(s.openBlock(),s.createElementBlock("div",Ao,s.toDisplayString(s.unref(o)("invalid-app-id")),1)):s.createCommentVNode("",!0)],64))}});exports.AuthRoute=ja,exports.LoginRoute=za,exports.RegisterRoute=$a,exports._sfc_main=Ro,exports.useElementSetup=function(e){function t(){e.appId&&s.createPassageInstance(e.appId,e.tokenStore);const{updateDefaultCountryCode:t}=s.useDefaultCountryCode();t(e.defaultCountryCode);const{setBeforeAuth:n,setOnSuccess:a,setOnEvent:o}=A();n(e.beforeAuth),a(e.onSuccess),o(e.onEvent)}t(),s.onBeforeUpdate((()=>{t()}));const{languageLoading:n}=s.useStoreLocale(e),{currentTheme:a}=s.useThemeSetup(e),o=s.ref();return s.useIntlTelInput(o),{languageLoading:n,containerRef:o,currentTheme:a}};
//# 
