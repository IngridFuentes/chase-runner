{"ast":null,"code":"import { resetLoginForm } from \"./loginForm.js\";\nimport { fetchRuns, clearRuns } from \"./fetchRuns.js\";\n\n// synchronous action creators\nexport const setCurrentUser = user => {\n  return {\n    type: \"SET_CURRENT_USER\",\n    user\n  };\n};\nexport const clearCurrentUser = () => {\n  return {\n    type: \"CLEAR_CURRENT_USER\"\n  };\n};\n\n// asynchronous action creators\n\n// export const login = (credentials, history) => {\n//     console.log(credentials, history, 'history')\n//     return async (dispatch) => {\n//         try{ \n//         const resp = await fetch('http://localhost:3000/api/v1/login', {\n//             credentials: 'include',\n//             method: 'POST',\n//             headers: {\n//               'Content-Type': 'application/json',\n//             },\n//             body: JSON.stringify(credentials),\n//           });\n//           const user = await resp.json();\n//                 if(user.error){\n//                     alert(user.error)\n//                 } else {\n//                     dispatch({ type: 'SET_CURRENT_USER', user: user })\n//                     dispatch(fetchRuns())\n//                     dispatch(resetLoginForm())\n//                     console.log(history, 'history')\n//                     history.push('/profile')                  \n//                 }\n//         } catch(error){\n//             console.log(error)\n//         } \n//         };\n// }\n\nexport const login = (credentials, navigate) => {\n  return dispatch => {\n    // fetch('/csrf_tokens')\n    // .then((resp) => resp.json())\n    // .then((data) => {\n    // const csrfToken = data.csrfToken;\n    let token = document.querySelector('meta[name=\"csrf-token\"]').content;\n    return fetch('http://localhost:3000/login', {\n      credentials: 'include',\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-CSRF-Token': token\n      },\n      body: JSON.stringify({\n        user: {\n          email: \"sonia@email.com\",\n          password: \"123456\"\n        }\n      })\n    }).then(resp => resp.json()).then(user => {\n      if (user.error) {\n        alert(user.error);\n      } else {\n        dispatch({\n          type: 'SET_CURRENT_USER',\n          user: user\n        });\n        dispatch(fetchRuns());\n        dispatch(resetLoginForm());\n        navigate('/profile');\n      }\n    }).catch(console.log);\n  };\n};\nexport const logout = event => {\n  return dispatch => {\n    dispatch(clearCurrentUser());\n    dispatch(clearRuns());\n    return fetch('http://localhost:3000/api/v1/logout', {\n      credentials: \"include\",\n      method: \"DELETE\"\n    });\n  };\n};\n\n// export const getCurrentUser = () => {\n//     // console.log(\"DISPATCHING GET CURRENT USER\")\n//     return(dispatch) => {\n//             return fetch('http://localhost:3000/api/v1/get_current_user', {\n//                 credentials: \"include\",\n//                 method: 'GET',\n//                 headers: {\n//                     \"Content-Type\": \"application/json\"\n//                 }\n//             })\n//             .then(resp => {return resp.json()})\n//             .then(user => { \n//                 if(user.error){\n//                     alert(user.error)\n//                 } else {\n//                     dispatch(setCurrentUser(user))\n//                 }\n//             })\n\n//     };\n// }","map":{"version":3,"names":["resetLoginForm","fetchRuns","clearRuns","setCurrentUser","user","type","clearCurrentUser","login","credentials","navigate","dispatch","token","document","querySelector","content","fetch","method","headers","body","JSON","stringify","email","password","then","resp","json","error","alert","catch","console","log","logout","event"],"sources":["/Users/ingridf/Documents/chase-runner/src/actions/currentUser.js"],"sourcesContent":["import { resetLoginForm } from \"./loginForm.js\"\nimport { fetchRuns, clearRuns } from \"./fetchRuns.js\"\n\n\n\n// synchronous action creators\nexport const setCurrentUser = user =>  {\n    return {\n        type: \"SET_CURRENT_USER\",\n        user\n    }\n}\n\nexport const clearCurrentUser = () => {\n    return {\n        type: \"CLEAR_CURRENT_USER\"\n    }\n}\n\n// asynchronous action creators\n\n// export const login = (credentials, history) => {\n//     console.log(credentials, history, 'history')\n//     return async (dispatch) => {\n//         try{ \n//         const resp = await fetch('http://localhost:3000/api/v1/login', {\n//             credentials: 'include',\n//             method: 'POST',\n//             headers: {\n//               'Content-Type': 'application/json',\n//             },\n//             body: JSON.stringify(credentials),\n//           });\n//           const user = await resp.json();\n//                 if(user.error){\n//                     alert(user.error)\n//                 } else {\n//                     dispatch({ type: 'SET_CURRENT_USER', user: user })\n//                     dispatch(fetchRuns())\n//                     dispatch(resetLoginForm())\n//                     console.log(history, 'history')\n//                     history.push('/profile')                  \n//                 }\n//         } catch(error){\n//             console.log(error)\n//         } \n//         };\n// }\n\nexport const login = (credentials, navigate) => {\n    return (dispatch) => {\n        // fetch('/csrf_tokens')\n        // .then((resp) => resp.json())\n        // .then((data) => {\n        // const csrfToken = data.csrfToken;\n    let token = document.querySelector('meta[name=\"csrf-token\"]').content;\n      return fetch('http://localhost:3000/login', {\n        credentials: 'include',\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Requested-With': 'XMLHttpRequest',\n          'X-CSRF-Token': token,\n        },\n        body: JSON.stringify({\n          user: {\n            email: \"sonia@email.com\",\n            password: \"123456\",\n          },\n        }),\n      })\n    \n        .then((resp) => resp.json())\n        .then((user) => {\n          if (user.error) {\n            alert(user.error);\n          } else {\n            dispatch({ type: 'SET_CURRENT_USER', user: user });\n            dispatch(fetchRuns());\n            dispatch(resetLoginForm());\n            navigate('/profile');\n          }\n        })\n        .catch(console.log);\n    };\n  };\nexport const logout = event => {\n    return dispatch => {\n        dispatch(clearCurrentUser())\n        dispatch(clearRuns())\n        return fetch('http://localhost:3000/api/v1/logout', {\n            credentials: \"include\",\n            method: \"DELETE\"\n        })\n    }\n}\n\n// export const getCurrentUser = () => {\n//     // console.log(\"DISPATCHING GET CURRENT USER\")\n//     return(dispatch) => {\n//             return fetch('http://localhost:3000/api/v1/get_current_user', {\n//                 credentials: \"include\",\n//                 method: 'GET',\n//                 headers: {\n//                     \"Content-Type\": \"application/json\"\n//                 }\n//             })\n//             .then(resp => {return resp.json()})\n//             .then(user => { \n//                 if(user.error){\n//                     alert(user.error)\n//                 } else {\n//                     dispatch(setCurrentUser(user))\n//                 }\n//             })\n\n//     };\n// }\n\n"],"mappings":"AAAA,SAASA,cAAc,QAAQ,gBAAgB;AAC/C,SAASC,SAAS,EAAEC,SAAS,QAAQ,gBAAgB;;AAIrD;AACA,OAAO,MAAMC,cAAc,GAAGC,IAAI,IAAK;EACnC,OAAO;IACHC,IAAI,EAAE,kBAAkB;IACxBD;EACJ,CAAC;AACL,CAAC;AAED,OAAO,MAAME,gBAAgB,GAAGA,CAAA,KAAM;EAClC,OAAO;IACHD,IAAI,EAAE;EACV,CAAC;AACL,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAME,KAAK,GAAGA,CAACC,WAAW,EAAEC,QAAQ,KAAK;EAC5C,OAAQC,QAAQ,IAAK;IACjB;IACA;IACA;IACA;IACJ,IAAIC,KAAK,GAAGC,QAAQ,CAACC,aAAa,CAAC,yBAAyB,CAAC,CAACC,OAAO;IACnE,OAAOC,KAAK,CAAC,6BAA6B,EAAE;MAC1CP,WAAW,EAAE,SAAS;MACtBQ,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE,kBAAkB;QAClC,kBAAkB,EAAE,gBAAgB;QACpC,cAAc,EAAEN;MAClB,CAAC;MACDO,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QACnBhB,IAAI,EAAE;UACJiB,KAAK,EAAE,iBAAiB;UACxBC,QAAQ,EAAE;QACZ;MACF,CAAC;IACH,CAAC,CAAC,CAECC,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACC,IAAI,CAAC,CAAC,CAAC,CAC3BF,IAAI,CAAEnB,IAAI,IAAK;MACd,IAAIA,IAAI,CAACsB,KAAK,EAAE;QACdC,KAAK,CAACvB,IAAI,CAACsB,KAAK,CAAC;MACnB,CAAC,MAAM;QACLhB,QAAQ,CAAC;UAAEL,IAAI,EAAE,kBAAkB;UAAED,IAAI,EAAEA;QAAK,CAAC,CAAC;QAClDM,QAAQ,CAACT,SAAS,CAAC,CAAC,CAAC;QACrBS,QAAQ,CAACV,cAAc,CAAC,CAAC,CAAC;QAC1BS,QAAQ,CAAC,UAAU,CAAC;MACtB;IACF,CAAC,CAAC,CACDmB,KAAK,CAACC,OAAO,CAACC,GAAG,CAAC;EACvB,CAAC;AACH,CAAC;AACH,OAAO,MAAMC,MAAM,GAAGC,KAAK,IAAI;EAC3B,OAAOtB,QAAQ,IAAI;IACfA,QAAQ,CAACJ,gBAAgB,CAAC,CAAC,CAAC;IAC5BI,QAAQ,CAACR,SAAS,CAAC,CAAC,CAAC;IACrB,OAAOa,KAAK,CAAC,qCAAqC,EAAE;MAChDP,WAAW,EAAE,SAAS;MACtBQ,MAAM,EAAE;IACZ,CAAC,CAAC;EACN,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}