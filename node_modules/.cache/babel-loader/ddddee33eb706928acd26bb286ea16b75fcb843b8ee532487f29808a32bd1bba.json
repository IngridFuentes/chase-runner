{"ast":null,"code":"import { resetLoginForm } from \"./loginForm.js\";\nimport { fetchRuns, clearRuns } from \"./fetchRuns.js\";\n\n// synchronous action creators\nexport const setCurrentUser = user => {\n  return {\n    type: \"SET_CURRENT_USER\",\n    user\n  };\n};\nexport const clearCurrentUser = () => {\n  return {\n    type: \"CLEAR_CURRENT_USER\"\n  };\n};\n\n// asynchronous action creators\n\nexport const login = (credentials, history) => {\n  // console.log(credentials, history, 'history')\n  return async dispatch => {\n    try {\n      const response = await fetch('http://localhost:3001/api/v1/login', {\n        credentials: 'include',\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(credentials)\n      });\n      const user = await response.json();\n      if (user.error) {\n        alert(user.error);\n      } else {\n        dispatch({\n          type: 'SET_CURRENT_USER',\n          user: user\n        });\n        dispatch(fetchRuns());\n        dispatch(resetLoginForm());\n        history.push('/profile');\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\nexport const logout = event => {\n  return dispatch => {\n    dispatch(clearCurrentUser());\n    dispatch(clearRuns());\n    return fetch('http://localhost:3001/api/v1/logout', {\n      credentials: \"include\",\n      method: \"DELETE\"\n    });\n  };\n};\nexport const getCurrentUser = () => {\n  // console.log(\"DISPATCHING GET CURRENT USER\")\n  return dispatch => {\n    return fetch('http://localhost:3001/api/v1/get_current_user', {\n      credentials: \"include\",\n      method: 'GET',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(resp => {\n      return resp.json();\n    }).then(user => {\n      if (user.error) {\n        alert(user.error);\n      } else {\n        dispatch(setCurrentUser(user));\n      }\n    });\n  };\n};","map":{"version":3,"names":["resetLoginForm","fetchRuns","clearRuns","setCurrentUser","user","type","clearCurrentUser","login","credentials","history","dispatch","response","fetch","method","headers","body","JSON","stringify","json","error","alert","push","console","log","logout","event","getCurrentUser","then","resp"],"sources":["/Users/ingridf/Documents/chase-runner/src/actions/currentUser.js"],"sourcesContent":["import { resetLoginForm } from \"./loginForm.js\"\nimport { fetchRuns, clearRuns } from \"./fetchRuns.js\"\n\n\n// synchronous action creators\nexport const setCurrentUser = user =>  {\n    return {\n        type: \"SET_CURRENT_USER\",\n        user\n    }\n}\n\nexport const clearCurrentUser = () => {\n    return {\n        type: \"CLEAR_CURRENT_USER\"\n    }\n}\n\n// asynchronous action creators\n\nexport const login = (credentials, history) => {\n    // console.log(credentials, history, 'history')\n    return async (dispatch) => {\n        try{ \n        const response = await fetch('http://localhost:3001/api/v1/login', {\n            credentials: 'include',\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(credentials),\n          });\n          const user = await response.json();\n\n                if(user.error){\n                    alert(user.error)\n                } else {\n                    dispatch({ type: 'SET_CURRENT_USER', user: user })\n                    dispatch(fetchRuns())\n                    dispatch(resetLoginForm())\n                    history.push('/profile')\n                    \n                }\n        } catch(error){\n            console.log(error)\n        }\n        \n        };\n}\n\nexport const logout = event => {\n    return dispatch => {\n        dispatch(clearCurrentUser())\n        dispatch(clearRuns())\n        return fetch('http://localhost:3001/api/v1/logout', {\n            credentials: \"include\",\n            method: \"DELETE\"\n        })\n    }\n}\n\nexport const getCurrentUser = () => {\n    // console.log(\"DISPATCHING GET CURRENT USER\")\n    return(dispatch) => {\n            return fetch('http://localhost:3001/api/v1/get_current_user', {\n                credentials: \"include\",\n                method: 'GET',\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            })\n            .then(resp => {return resp.json()})\n            .then(user => { \n                if(user.error){\n                    alert(user.error)\n                } else {\n                    dispatch(setCurrentUser(user))\n                }\n            })\n        };\n}\n\n"],"mappings":"AAAA,SAASA,cAAc,QAAQ,gBAAgB;AAC/C,SAASC,SAAS,EAAEC,SAAS,QAAQ,gBAAgB;;AAGrD;AACA,OAAO,MAAMC,cAAc,GAAGC,IAAI,IAAK;EACnC,OAAO;IACHC,IAAI,EAAE,kBAAkB;IACxBD;EACJ,CAAC;AACL,CAAC;AAED,OAAO,MAAME,gBAAgB,GAAGA,CAAA,KAAM;EAClC,OAAO;IACHD,IAAI,EAAE;EACV,CAAC;AACL,CAAC;;AAED;;AAEA,OAAO,MAAME,KAAK,GAAGA,CAACC,WAAW,EAAEC,OAAO,KAAK;EAC3C;EACA,OAAO,MAAOC,QAAQ,IAAK;IACvB,IAAG;MACH,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,oCAAoC,EAAE;QAC/DJ,WAAW,EAAE,SAAS;QACtBK,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACT,WAAW;MAClC,CAAC,CAAC;MACF,MAAMJ,IAAI,GAAG,MAAMO,QAAQ,CAACO,IAAI,CAAC,CAAC;MAE5B,IAAGd,IAAI,CAACe,KAAK,EAAC;QACVC,KAAK,CAAChB,IAAI,CAACe,KAAK,CAAC;MACrB,CAAC,MAAM;QACHT,QAAQ,CAAC;UAAEL,IAAI,EAAE,kBAAkB;UAAED,IAAI,EAAEA;QAAK,CAAC,CAAC;QAClDM,QAAQ,CAACT,SAAS,CAAC,CAAC,CAAC;QACrBS,QAAQ,CAACV,cAAc,CAAC,CAAC,CAAC;QAC1BS,OAAO,CAACY,IAAI,CAAC,UAAU,CAAC;MAE5B;IACR,CAAC,CAAC,OAAMF,KAAK,EAAC;MACVG,OAAO,CAACC,GAAG,CAACJ,KAAK,CAAC;IACtB;EAEA,CAAC;AACT,CAAC;AAED,OAAO,MAAMK,MAAM,GAAGC,KAAK,IAAI;EAC3B,OAAOf,QAAQ,IAAI;IACfA,QAAQ,CAACJ,gBAAgB,CAAC,CAAC,CAAC;IAC5BI,QAAQ,CAACR,SAAS,CAAC,CAAC,CAAC;IACrB,OAAOU,KAAK,CAAC,qCAAqC,EAAE;MAChDJ,WAAW,EAAE,SAAS;MACtBK,MAAM,EAAE;IACZ,CAAC,CAAC;EACN,CAAC;AACL,CAAC;AAED,OAAO,MAAMa,cAAc,GAAGA,CAAA,KAAM;EAChC;EACA,OAAOhB,QAAQ,IAAK;IACZ,OAAOE,KAAK,CAAC,+CAA+C,EAAE;MAC1DJ,WAAW,EAAE,SAAS;MACtBK,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QACL,cAAc,EAAE;MACpB;IACJ,CAAC,CAAC,CACDa,IAAI,CAACC,IAAI,IAAI;MAAC,OAAOA,IAAI,CAACV,IAAI,CAAC,CAAC;IAAA,CAAC,CAAC,CAClCS,IAAI,CAACvB,IAAI,IAAI;MACV,IAAGA,IAAI,CAACe,KAAK,EAAC;QACVC,KAAK,CAAChB,IAAI,CAACe,KAAK,CAAC;MACrB,CAAC,MAAM;QACHT,QAAQ,CAACP,cAAc,CAACC,IAAI,CAAC,CAAC;MAClC;IACJ,CAAC,CAAC;EACN,CAAC;AACT,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}