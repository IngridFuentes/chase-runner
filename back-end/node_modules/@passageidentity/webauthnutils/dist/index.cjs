"use strict";var P=Object.create;var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var O=(r,e)=>{for(var t in e)d(r,t,{get:e[t],enumerable:!0})},m=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of A(e))!w.call(r,a)&&a!==t&&d(r,a,{get:()=>e[a],enumerable:!(i=S(e,a))||i.enumerable});return r};var K=(r,e,t)=>(t=r!=null?P(v(r)):{},m(e||!r||!r.__esModule?d(t,"default",{value:r,enumerable:!0}):t,r)),B=r=>m(d({},"__esModule",{value:!0}),r);var s=(r,e,t)=>new Promise((i,a)=>{var o=l=>{try{p(t.next(l))}catch(g){a(g)}},h=l=>{try{p(t.throw(l))}catch(g){a(g)}},p=l=>l.done?i(l.value):Promise.resolve(l.value).then(o,h);p((t=t.apply(r,e)).next())});var T={};O(T,{CreateCredentialUtils:()=>u,GetCredentialUtils:()=>C});module.exports=B(T);var y=(r,e)=>s(void 0,null,function*(){let t,i=new Promise(a=>{t=setTimeout(a,e)});return Promise.race([r,i]).then(a=>(clearTimeout(t),a))});var n=class{static encodeBytes(e){let i=btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_");return f(i)}static decodeBytes(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),i=f(t);return Uint8Array.from(atob(i),o=>o.charCodeAt(0))}},f=r=>{let e=r.indexOf("=");return r.slice(0,e===-1?r.length:e)};var u=class{static createCredentialAvailable(){return s(this,null,function*(){let e={securityKey:!1,platform:!1,isAvailable:!1};return window.PublicKeyCredential&&(e.securityKey=!0,e.isAvailable=!0,yield y(window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().then(t=>{e.platform=t}).catch(()=>console.log("Something went wrong.")),1e3)),e})}static parsePublicKey(e){if(e.challenge=n.decodeBytes(e.challenge.toString()),e.user.id=n.decodeBytes(e.user.id.toString()),e.excludeCredentials)for(let t=0;t<e.excludeCredentials.length;t++){let i=e.excludeCredentials[t];i.id=n.decodeBytes(i.id.toString())}return e}static getTransports(e){let t=[];return e.response.getTransports&&typeof e.response.getTransports=="function"&&(t=e.response.getTransports()),t}static createCredential(e){return s(this,null,function*(){let t={credential:null,transports:[]},i=this.parsePublicKey(e),a=yield navigator.credentials.create({publicKey:i}).then(o=>o);return a==null||(t.credential=a,t.transports=this.getTransports(a)),t})}};var b=K(require("ua-parser-js"),1),c=class{constructor(){this.userAgent=new b.default}getSyncedCredential(){return!!(this._isiOSPasskeySupported()||this._isMacPasskeySupported()||this._isChromeSyncedCredential())}getCrossDeviceCredential(){return!!(this._isiOSPasskeySupported()||this._isMacPasskeySupported()||this._isChromiumCrossDevice())}_isiOSPasskeySupported(){return this.userAgent.getOS().name=="iOS"&&parseFloat(this.userAgent.getOS().version||"")>=16}_isMacPasskeySupported(){return this.userAgent.getBrowser().name=="Safari"&&parseFloat(this.userAgent.getBrowser().version||"")>=16&&this.userAgent.getOS().name=="Mac OS"}_isChromeSyncedCredential(){var i;let e=(i=this.userAgent.getOS().name)!=null?i:"";return((e==null?void 0:e.includes("Windows"))||(e==null?void 0:e.includes("Mac OS"))||(e==null?void 0:e.includes("Android")))&&this.userAgent.getBrowser().name=="Chrome"&&parseFloat(this.userAgent.getBrowser().version||"")>=108}_isChromiumCrossDevice(){return this.userAgent.getOS().name==="Android"?!1:this.userAgent.getEngine().name=="Blink"&&parseFloat(this.userAgent.getBrowser().version||"")>=109}};var C=class{static parsePublicKey(e){if(e.challenge=n.decodeBytes(e.challenge.toString()),e.allowCredentials){for(let t=0;t<e.allowCredentials.length;t++){let i=e.allowCredentials[t];i.id=n.decodeBytes(i.id.toString())}return e}return e}static getCredential(e,t){return s(this,null,function*(){return yield navigator.credentials.get({mediation:t==null?void 0:t.mediation,signal:t==null?void 0:t.signal,publicKey:this.parsePublicKey(e)}).then(a=>a)})}static getCredentialAvailable(){return s(this,null,function*(){let e={securityKey:!1,platform:!1,syncedCredential:!1,crossDeviceCredential:!1,conditionalUI:!1,isAvailable:!1},t=yield u.createCredentialAvailable();if(e.securityKey=t.securityKey,e.platform=t.platform,e.isAvailable=t.isAvailable,!e.securityKey)return e;e.conditionalUI=yield this._isConditionalMediationAvailable();let i=new c;return e.syncedCredential=i.getSyncedCredential(),e.crossDeviceCredential=i.getCrossDeviceCredential(),e})}static _isConditionalMediationAvailable(){return s(this,null,function*(){return PublicKeyCredential.isConditionalMediationAvailable?yield PublicKeyCredential.isConditionalMediationAvailable():!1})}};0&&(module.exports={CreateCredentialUtils,GetCredentialUtils});
//# sourceMappingURL=index.cjs.map